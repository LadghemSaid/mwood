<?php namespace Elementor;use \ElementsKit\Modules\Onepage_Scroll\Init;class ElementsKit_Extend_Onepage_Scroll{public function __construct(){add_action('elementor/element/post/document_settings/after_section_end',[$this,'register_page_controls']);add_action('elementor/element/section/section_advanced/after_section_end',[$this,'register_section_controls']);add_action('wp_footer',[$this,'generate_navigation_markup']);add_action('wp_ajax_generate_navigation_markup',[$this,'generate_navigation_markup']);}public function register_page_controls(Controls_Stack $element){$element->start_controls_section('ekit_page_settings',['label'=>esc_html__('ElementsKit Settings','elementskit'),'tab'=>Controls_Manager::TAB_SETTINGS,]);$element->add_control('ekit_onepagescroll',['label'=>esc_html__('Enable Onepage Scroll','elementskit'),'type'=>Controls_Manager::SWITCHER,'return_value'=>'block','frontend_available'=>true,'selectors'=>['.onepage_scroll_nav'=>'display: {{VALUE}};',],]);if(\ElementsKit::PACKAGE_TYPE==='pro'){$this->controls_pro_onepagescroll($element);}$element->end_controls_section();}public function register_section_controls(Controls_Stack $element){$element->start_controls_section('ekit_onepagescroll_section',['label'=>esc_html__('ElementsKit Onepage Scroll','elementskit'),'tab'=>Controls_Manager::TAB_ADVANCED,'hide_in_inner'=>true,]);$element->add_control('ekit_has_onepagescroll',['label'=>esc_html__('Enable Section','elementskit'),'type'=>Controls_Manager::SWITCHER,'frontend_available'=>true,'return_value'=>'section','prefix_class'=>'fp-',]);if(\ElementsKit::PACKAGE_TYPE==='pro'){$this->controls_pro_onepagescroll_section($element);}$element->end_controls_section();}public function controls_pro_onepagescroll($element){$element->add_control('ekit_onepagescroll_heading',['label'=>__('Onepage Scroll Settings','elementskit'),'type'=>\Elementor\Controls_Manager::HEADING,'separator'=>'before','condition'=>['ekit_onepagescroll'=>'block'],]);$element->add_control('ekit_onepagescroll_nav',['label'=>esc_html__('Navigation Style','elementskit'),'type'=>Controls_Manager::SELECT,'default'=>'0','groups'=>['0'=>esc_html__('None','elementskit'),['label'=>esc_html__('Circle','elementskit'),'options'=>['circle-scale-up'=>esc_html__('Scale Up','elementskit'),'circle-fill-in'=>esc_html__('Fill In','elementskit'),'circle-fill-out'=>esc_html__('Fill Out','elementskit'),'circle-stroke'=>esc_html__('Stroke','elementskit'),'circle-stroke-dot'=>esc_html__('Stroke Dot','elementskit'),'circle-stroke-simple'=>esc_html__('Stroke Simple','elementskit'),'circle-dot-move'=>esc_html__('Dot Move','elementskit'),'circle-timeline'=>esc_html__('Timeline','elementskit'),]],['label'=>esc_html__('Square','elementskit'),'options'=>['square-scale-up'=>esc_html__('Scale Up','elementskit'),]],['label'=>esc_html__('Line','elementskit'),'options'=>['line-grow'=>esc_html__('Line Grow','elementskit'),'line-shrink'=>esc_html__('Line Shrink','elementskit'),'line-fill'=>esc_html__('Line Fill','elementskit'),'line-move'=>esc_html__('Line Move','elementskit'),]],'icon'=>esc_html__('Custom Icon','elementskit'),],'frontend_available'=>true,'condition'=>['ekit_onepagescroll'=>'block']]);$element->add_control('ekit_onepagescroll_nav_icon',['label'=>esc_html__('Navigation Icon','elementskit'),'type'=>Controls_Manager::ICONS,'default'=>['value'=>'fas fa-circle','library'=>'solid',],'frontend_available'=>true,'condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav'=>'icon',]]);$element->add_control('ekit_onepagescroll_nav_pos',['label'=>esc_html__('Navigation Position','elementskit'),'type'=>Controls_Manager::CHOOSE,'default'=>'top','options'=>['top'=>['title'=>esc_html__('Top','elementskit'),'icon'=>'fa fa-angle-up',],'bottom'=>['title'=>esc_html__('Bottom','elementskit'),'icon'=>'fa fa-angle-down',],'left'=>['title'=>esc_html__('Left','elementskit'),'icon'=>'fa fa-angle-left',],'right'=>['title'=>esc_html__('Right','elementskit'),'icon'=>'fa fa-angle-right',],],'toggle'=>false,'frontend_available'=>true,'condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav!'=>'0',],]);$element->add_control('ekit_onepagescroll_nav_pos_offset',['label'=>esc_html__('Navigation Position Offset','elementskit'),'type'=>Controls_Manager::SLIDER,'size_units'=>['px','%'],'range'=>['px'=>['min'=>0,'max'=>1000,'step'=>10,],'%'=>['min'=>0,'max'=>100,],],'default'=>['unit'=>'%','size'=>'50'],'condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav!'=>'0',],'selectors'=>['.onepage_scroll_nav.met-top, .onepage_scroll_nav.met-bottom'=>'left: {{SIZE}}{{UNIT}};','.onepage_scroll_nav.met-left, .onepage_scroll_nav.met-right'=>'top: {{SIZE}}{{UNIT}};',],]);$element->add_control('ekit_onepagescroll_nav_spacing',['label'=>esc_html__('Navigation Spacing','elementskit'),'type'=>Controls_Manager::SLIDER,'size_units'=>['px','%'],'default'=>['unit'=>'px','size'=>'20'],'condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav!'=>'0'],'selectors'=>['.onepage_scroll_nav.met-top, .onepage_scroll_nav.met-bottom'=>'margin: {{SIZE}}{{UNIT}} 0;','.onepage_scroll_nav.met-left, .onepage_scroll_nav.met-right'=>'margin: 0 {{SIZE}}{{UNIT}};',],]);$element->add_control('ekit_onepagescroll_nav_color',['label'=>esc_html__('Navigation Color','elementskit'),'type'=>Controls_Manager::COLOR,'default'=>'#111','condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav!'=>'0',],'selectors'=>['.onepage_scroll_nav .editor\:met_color'=>'color: {{VALUE}};','.onepage_scroll_nav .editor\:met_bgc, .onepage_scroll_nav .editor\:before\:met_bgc:before'=>'background-color: {{VALUE}};','.onepage_scroll_nav .editor\:met_bdc, .onepage_scroll_nav .active > .editor\:active\:met_bdc'=>'border-color: {{VALUE}};',],]);$element->add_group_control(\Elementor\Group_Control_Typography::get_type(),['name'=>'ekit_onepagescroll_nav_tooltip_font','label'=>esc_html__('Tooltip Typography','elementskit'),'selector'=>'.onepage_scroll_nav .nav_tooltip','condition'=>['ekit_onepagescroll'=>'block','ekit_onepagescroll_nav!'=>'0',],]);}public function controls_pro_onepagescroll_section($element){$element->add_control('ekit_has_onepagescroll_dot',['label'=>esc_html__('Enable Dot','elementskit'),'type'=>Controls_Manager::SWITCHER,'frontend_available'=>true,'default'=>'yes','render_type'=>'none',]);$element->add_control('ekit_onepagescroll_tooltip_text',['label'=>esc_html__('Tooltip Text','elementskit'),'type'=>Controls_Manager::TEXT,'frontend_available'=>true,'render_type'=>'none',]);}public function generate_navigation_markup(){$is_active=Init::get_page_setting('ekit_onepagescroll');$is_nav=$nav_style=Init::get_page_setting('ekit_onepagescroll_nav');$is_pro=\ElementsKit::PACKAGE_TYPE==='pro';$is_editor=\Elementor\Plugin::$instance->preview->is_preview_mode();$nav_pos=Init::get_page_setting('ekit_onepagescroll_nav_pos');$nav_icon=Init::get_page_setting('ekit_onepagescroll_nav_icon');$is_ajax=isset($_POST['navStyle'])&&sanitize_text_field($_POST['navStyle']);if($is_ajax):$is_active='yes';$is_nav=$nav_style=sanitize_text_field($_POST['navStyle']);$nav_pos=sanitize_text_field($_POST['navPos']);$nav_icon=['value'=>sanitize_text_field($_POST['navIcon']['value']),];elseif(!$is_ajax&&$is_editor):echo '<div id="onepage_scroll_nav_wrap">';endif;if(!($is_pro&&$is_active&&$is_nav)){echo '</div>';return;}$classlist=array('wrapper'=>'nav-style-'.$nav_style.' met_d--none met_pos--fixed ','ul'=>'met_list--none met_m--0 met_p--0 met_lh--0 ','li'=>'met_not_last_mb--20 ','link'=>'','tooltip'=>'','arrow'=>'',);switch($nav_pos){case 'top':$classlist['wrapper'].='met-'.$nav_pos.' met_top--0 met_left--50p met_translateLeft--m50p ';$classlist['ul'].='met_d--flex ';$classlist['li']='met_not_last_mr--20 ';$classlist['tooltip'].='met_top--100p ';$classlist['arrow'].='met_bdb_color--current met_top--100p ';break;case 'bottom':$classlist['wrapper'].='met-'.$nav_pos.' met_bottom--0 met_left--50p met_translateLeft--m50p ';$classlist['ul'].='met_d--flex ';$classlist['li']='met_not_last_mr--20 ';$classlist['tooltip'].='met_bottom--100p ';$classlist['arrow'].='met_bdt_color--current met_bottom--100p ';break;case 'left':$classlist['wrapper'].='met-'.$nav_pos.' met_top--50p met_left--0 met_translateTop--m50p ';$classlist['tooltip'].='met_left--100p ';$classlist['arrow'].='met_bdr_color--current met_left--100p ';break;case 'right':$classlist['wrapper'].='met-'.$nav_pos.' met_top--50p met_right--0 met_translateTop--m50p ';$classlist['tooltip'].='met_right--100p ';$classlist['arrow'].='met_bdl_color--current met_right--100p ';break;}include_once('nav-styles/'.$nav_style.'.php');if($is_ajax):wp_die();elseif(!$is_ajax&&$is_editor):echo '</div>';endif;}}
!function(e){"use strict";function t(t){var i=e("#tm_epo_consent_for_transmit");if(i.length&&i.is(":checked")&&0==f){f=0,e(".tm-license-button").block({message:null,overlayCSS:{background:"#fff url("+tm_epo_admin.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var n={action:"tm_"+t+"_license",username:e("#tm_epo_envato_username").val(),key:e("#tm_epo_envato_purchasecode").val(),api_key:e("#tm_epo_envato_apikey").val(),security:tm_epo_admin.settings_nonce};e.post(tm_epo_admin.ajax_url,n,function(t){var i;i=t&&-1!=t?t&&t.message&&t.result&&("-3"==t.result||"-2"==t.result||"wp_error"==t.result||"server_error"==t.result)?t.message:t&&t.message&&t.result&&"4"==t.result?t.message:"":tm_epo_admin.i18n_invalid_request,e(".tm-license-result").html(i),e(".tm-license-button").unblock()},"json").always(function(i){e(".tm-license-button").unblock(),f=0,i&&i.result&&"4"==i.result&&("activate"==t&&(e(".tm-deactivate-license").removeClass("tm-hidden"),e(".tm-activate-license").removeClass("tm-hidden").addClass("tm-hidden")),"deactivate"==t&&(e(".tm-deactivate-license").removeClass("tm-hidden").addClass("tm-hidden"),e(".tm-activate-license").removeClass("tm-hidden")))})}}function i(t){var i=t.val(),a=e("#tm_epo_options_placement").closest("tr"),l=e("#tm_epo_totals_box_placement").closest("tr"),d=e("#tm_epo_options_placement_custom_hook").closest("tr"),r=e("#tm_epo_totals_box_placement_custom_hook").closest("tr");"action"==i?(a.hide(),l.hide(),d.hide(),r.hide()):(a.show(),l.show(),n(e("#tm_epo_options_placement")),o(e("#tm_epo_totals_box_placement")))}function n(t){var i=t.val(),n=e("#tm_epo_options_placement_custom_hook").closest("tr");"custom"==i?n.show():n.hide()}function a(t){var i=t.val(),n=e("#tm_epo_floating_totals_box_visibility").closest("tr"),a=e("#tm_epo_floating_totals_box_add_button").closest("tr");"disable"==i?(n.hide(),a.hide()):(n.show(),a.show())}function l(t){var i=t.is(":checked"),n=e("#tm_epo_show_price_inside_option_hidden_even").closest("tr"),a=e("#tm_epo_multiply_price_inside_option").closest("tr");i?(n.show(),a.show()):(n.hide(),a.hide())}function o(t){var i=t.val(),n=e("#tm_epo_totals_box_placement_custom_hook").closest("tr");"custom"==i?n.show():n.hide()}function d(t){var i=t.val(),n=e("#tm_epo_css_styles_style").closest("tr");"on"==i?n.show():n.hide()}function r(t){e(t).closest("td").css("position","relative").append('<div class="tm-border-type"></div>')}function s(t){var i=t.val();e(".tm-border-type").removeClass("square round shadow thinline").addClass(i)}function m(e){return e.closest("tr")}function c(e,t,i,n){m(i).addClass("tm-hidden"),m(i.filter("."+e)).removeClass("tm-hidden"),n.find(".tm-section-desc .tm-section-menu-item").removeClass("active"),t.addClass("active")}var u=!1,p={tc_builder_elements:wp.template("tc-builder-elements"),tc_builder_section:wp.template("tc-builder-section")};p=e.tc_apply_filters("tc_adjust_admin_template_engine",p),e.tmEPOAdmin={add_events:function(){e(document).on("click.cpf","#builder_export",function(t){t.preventDefault();var i=e(this);if(!i.data("doing_export")){i.data("doing_export",1).prepend('<i class="tm-icon tcfa tcfa-refresh tcfa-spin"></i>');var n,a;n=e.tmEPOAdmin.prepare_for_json(e("#post").tm_serializeObject()),a={action:"tm_export",metaserialized:n=e.toJSON(n),security:tm_epo_admin.export_nonce},e.post(tm_epo_admin.ajax_url,a,function(t){if(t&&t.result&&""!=t.result)window.location=t.result;else if(t&&t.error&&t.message){var i=e.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:tm_epo_admin.i18n_error_title}),n=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:i});e(".details_cancel").click(function(){n&&n.cancelfunc()})}},"json").always(function(e){i.data("doing_export",0).find(".tm-icon").remove()})}}),e("#builder_import_file").fileupload({dataType:"json",global:!1,url:tm_epo_admin.import_url,dropZone:null,add:function(t,i){var n=e.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:"",title:tm_epo_admin.i18n_import_title});i._to=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper",data:n});var a=e('<div class="tm_progress_bar tm_orange"><span class="tm_percent"></span></div><div class="tm_progress_info"><span class="tm_info"></span></div>');e('<div class="override-selection"><button type="button" class="tc tc-button details_override">'+tm_epo_admin.i18n_overwrite_existing_elements+'</button><button type="button" class="tc tc-button details_append">'+tm_epo_admin.i18n_append_new_elements+"</button></div>").appendTo("#temp_for_floatbox_insert"),e(".details_cancel").click(function(){i.abort(),i._to&&i._to.cancelfunc()}),(i.autoUpload||!1!==i.autoUpload&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){e(".details_override").click(function(){e("#temp_for_floatbox_insert").find(".override-selection").remove(),a.appendTo("#temp_for_floatbox_insert"),e(".tm_info").html(tm_epo_admin.i18n_importing),i.formData={action:"import",import_override:1},i.submit(),e(".flasho").addClass("tm_color_orange")}),e(".details_append").click(function(){e("#temp_for_floatbox_insert").find(".override-selection").remove(),a.appendTo("#temp_for_floatbox_insert"),e(".tm_info").html(tm_epo_admin.i18n_importing),i.formData={action:"import",import_override:0},i.submit(),e(".flasho").addClass("tm_color_orange")})})},done:function(t,i){i.result&&i.result.message&&e(".tm_info").html(i.result.message),i.result&&1==i.result.result?(e(".tm_progress_bar").removeClass("tm_orange").addClass("tm_turquoise"),e(".tm_info").removeClass("tm_color_pomegranate").addClass("tm_color_turquoise"),e(".flasho").removeClass("tm_color_orange tm_color_pomegranate").addClass("tm_color_turquoise"),e(".details_cancel").remove(),e(".tm_info").html(tm_epo_admin.i18n_saving),e(window).off("beforeunload.edit-post"),e("#post").submit()):(e(".tm_progress_bar").removeClass("tm_orange").addClass("tm_pomegranate"),e(".tm_info").removeClass("tm_color_turquoise").addClass("tm_color_pomegranate"),e(".flasho").removeClass("tm_color_orange tm_color_turquoise").addClass("tm_color_pomegranate"))},fail:function(t,i){i.result&&i.result.message&&e(".tm_info").removeClass("tm_color_turquoise").addClass("tm_color_pomegranate").html(i.result.message),e(".tm_progress_bar").removeClass("tm_orange").addClass("tm_pomegranate"),e(".flasho").removeClass("tm_color_orange tm_color_turquoise").addClass("tm_color_pomegranate")},progressall:function(t,i){var n=parseInt(i.loaded/i.total*100,10);e(".tm_progress_bar").css("width",n+"%"),e(".tm_percent").html(n+"%")},always:function(t,i){e("body").removeClass("overflow")}}),e(document).on("click.cpf","#builder_import,.tc-add-import-csv",function(t){t.preventDefault(),e("#builder_import_file").click()}),e(document).on("click.cpf","#builder_fullsize",function(t){t.preventDefault(),e("body").addClass("overflow");var i=e(".tm_mode_builder");i.length||(i=e(".builder_selector").closest(".postbox")),i.css({opacity:0}).addClass("fullsize"),e('<div class="fl-overlay forfullsize"></div>').css({zIndex:1e7,opacity:1,height:0}).appendTo("body").animate({opacity:1,height:"100%"},500,"easeOutExpo",function(){i.css({opacity:1}),e(".forfullsize").animate({opacity:0},300,"easeInExpo",function(){e(".forfullsize").remove()})})}),e(document).on("click.cpf","#builder_fullsize_close",function(t){t.preventDefault();var i=e(".tm_mode_builder");i.length||(i=e(".builder_selector").closest(".postbox")),e('<div class="fl-overlay forfullsize"></div>').css({zIndex:1e7,opacity:1,height:0}).appendTo("body").animate({opacity:1,height:"100%"},500,"easeOutExpo",function(){i.removeClass("fullsize"),e("body").removeClass("overflow"),e(".forfullsize").animate({opacity:0},300,"easeInExpo",function(){e(".forfullsize").remove()})})}),e(document).on("click.cpf",".builder-add-element",e.tmEPOAdmin.builder_add_element_onClick),e(document).on("click.cpf",".builder_add_section,.tc-add-section ",e.tmEPOAdmin.builder_add_section_onClick),e(document).on("click.cpf",".builder-add-section-and-element,.tc-add-element",e.tmEPOAdmin.builder_add_section_and_element_onClick),e(document).on("click.cpf",".builder_add_variation",e.tmEPOAdmin.builder_add_variation_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .edit",e.tmEPOAdmin.builder_section_item_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .clone",e.tmEPOAdmin.builder_section_clone_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .plus",e.tmEPOAdmin.builder_section_plus_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .minus",e.tmEPOAdmin.builder_section_minus_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .delete",e.tmEPOAdmin.builder_section_delete_onClick),e(document).on("click.cpf",".builder_wrapper .btitle .fold",e.tmEPOAdmin.builder_section_fold_onClick),e(document).on("click.cpf",".bitem .edit",e.tmEPOAdmin.builder_item_onClick),e(document).on("click.cpf",".bitem .clone",e.tmEPOAdmin.builder_clone_onClick),e(document).on("click.cpf",".bitem .plus",e.tmEPOAdmin.builder_plus_onClick),e(document).on("click.cpf",".bitem .minus",e.tmEPOAdmin.builder_minus_onClick),e(document).on("click",".bitem .delete",e.tmEPOAdmin.builder_delete_onClick),e(document).on("click.cpf",".builder-panel-add",e.tmEPOAdmin.builder_panel_add_onClick),e(document).on("click.cpf",".builder-panel-mass-add",e.tmEPOAdmin.builder_panel_mass_add_onClick),e(document).on("click.cpf",".builder-panel-populate",e.tmEPOAdmin.builder_panel_populate_onClick),e(document).on("click.cpf",".builder_panel_delete",e.tmEPOAdmin.builder_panel_delete_onClick),e(".builder_panel_delete").on("click.cpf",e.tmEPOAdmin.builder_panel_delete_onClick),e(document).on("click.cpf",".builder_panel_delete_all",e.tmEPOAdmin.builder_panel_delete_all_onClick),e(document).on("click.cpf",".builder_panel_up",function(){var t=e(this),i=t.closest(".options_wrap");i.prev().before(i),e.tmEPOAdmin.panels_reorder(t.closest(".panels_wrap")),e.tmEPOAdmin.paginattion_init("current")}),e(document).on("click.cpf",".builder_panel_down",function(){var t=e(this),i=t.closest(".options_wrap");i.next().after(i),e.tmEPOAdmin.panels_reorder(t.closest(".panels_wrap")),e.tmEPOAdmin.paginattion_init("current")}),e(document).on("keyup.cpf change.cpf",".tm_option_title",function(){e(this).closest(".options_wrap").find(".tm_option_value").val(e(this).val())}),e(document).on("click.cpf",".tm_upload_button",e.tmEPOAdmin.upload),e(document).on("change.cpf",".use_images,.tm-use-lightbox,.use_colors",e.tmEPOAdmin.tm_upload),e(document).on("change.cpf",".use_url",e.tmEPOAdmin.tm_url),e(document).on("change.cpf",".tm-qty-selector",e.tmEPOAdmin.tm_qty_selector),e(document).on("change.cpf",".tm-pricetype-selector",e.tmEPOAdmin.tm_pricetype_selector),e(document).on("change.cpf",".variations-display-as",e.tmEPOAdmin.variations_display_as),e(document).on("change.cpf",".tm-attribute .tm-changes-product-image",e.tmEPOAdmin.variations_display_as),e(document).on("click.cpf",".tm-upload-button-remove",e.tmEPOAdmin.tm_upload_button_remove_onClick),e(document).on("change.cpf",".tm-weekday-picker",e.tmEPOAdmin.tm_weekday_picker),e(document).on("click.cpf",".tm-tags-container .tab-header",function(){var t=e(this),i=t.closest(".tm-tags-container"),n=i.find(".tm-elements-container").find("li.tm-element-button"),a=i.find(".tab-header"),l=t.attr("data-tm-tag");a.removeClass("open").addClass("closed"),t.removeClass("closed").addClass("open"),"all"==l?n.removeClass("tm-hidden"):(n.addClass("tm-hidden"),n.filter("."+l).removeClass("tm-hidden"))}),e(document).on("click.cpf",".tm_editor_wrap",function(){var t=e(this).find("textarea");t.attr("id")&&(window.wpActiveEditor=t.attr("id"))}),e(document).on("change.cpf",".cpf-logic-element",e.tmEPOAdmin.cpf_logic_element_onchange),e(document).on("change.cpf",".cpf-logic-operator",e.tmEPOAdmin.cpf_logic_operator_onchange),e(document).on("change.cpf",".activate-sections-logic, .activate-element-logic",function(){1==parseInt(e(this).val())?e(this).parent().find(".builder-logic-div").show():e(this).parent().find(".builder-logic-div").hide()}),e(document).on("dblclick.cpf",".tm-default-radio",function(){e(this).removeAttr("checked").prop("checked",!1)}),e(document).on("click",".tm-element-label,.tm-internal-label",function(){var t=e(this);e.tmEPOAdmin.current_edit_label=t,t.addClass("tm-hidden").closest(".tm-label-desc").addClass("tm-hidden").next(".tm-label-desc-edit").removeClass("tm-hidden").find(".tm-internal-name").focus()}),e(document).mouseup(function(t){if(e.tmEPOAdmin.current_edit_label){var i=e.tmEPOAdmin.current_edit_label;if(!i.is(t.target)&&0===i.has(t.target).length&&!e(t.target).is(".tm-internal-name")){var n=i.closest(".tm-label-desc").next(".tm-label-desc-edit").find(".tm-internal-name");n.change(),i.is(".tm-internal-label")&&i.html(n.val()).removeClass("tm-hidden"),i.is(".tm-element-label")&&i.removeClass("tm-hidden").closest(".tm-label-desc").find(".tm-internal-label").html(n.val()),i.closest(".tm-label-desc").removeClass("tm-hidden").next(".tm-label-desc-edit").addClass("tm-hidden"),""===n.val()?i.closest(".tm-label-desc").removeClass("tc-has-value").addClass("tc-empty-value"):i.closest(".tm-label-desc").removeClass("tc-empty-value").addClass("tc-has-value"),e.tmEPOAdmin.current_edit_label=!1}}}),e(document).on("change.cpf",".multiple_radiobuttons_options",function(){var t=e(this).closest(".panels_wrap");"fee"==e(this).val()?t.find(".multiple_radiobuttons_options").val("fee"):t.find(".multiple_radiobuttons_options").filter(function(){return"fee"==this.value}).val(e(this).val())}),e(document).on("change.cpf",".tm_select_price_type",function(){var t=e(this).closest(".builder_element_wrap").find(".panels_wrap");"fee"==e(this).val()?(t.find(".multiple_selectbox_options").children('option[value="percentcurrenttotal"]').hide(),t.find(".multiple_selectbox_options").filter(function(){return"percentcurrenttotal"==this.value}).val("")):t.find(".multiple_selectbox_options").children('option[value="percentcurrenttotal"]').show()}),e(document).on("click.cpf",".cpf-add-rule",e.tmEPOAdmin.cpf_add_rule),e(document).on("click.cpf",".cpf-delete-rule",e.tmEPOAdmin.cpf_delete_rule),e(document).on("click.cpf",".tma-handle-wrap .tma-handle",e.tmEPOAdmin.builder_fold_onClick),e(document).on("keyup change","#temp_for_floatbox_insert .n[type=text]",function(){var t=e(this).val(),i=new RegExp("[^-0-9%.\\"+woocommerce_admin.mon_decimal_point+"]+","gi"),n=t.replace(i,"");if(t!==n&&(e(this).val(n),0==e(this).parent().find(".wc_error_tip").length)){var a=e(this).position();e(this).after('<div class="wc_error_tip">'+woocommerce_admin.i18n_mon_decimal_error+"</div>"),e(".wc_error_tip").css("left",a.left+e(this).width()-e(this).width()/2-e(".wc_error_tip").width()/2).css("top",a.top+e(this).height()).fadeIn("100")}return this}),e(document).on("click",".builder_elements .tc-handle",function(){var t=e(this),i=t.closest(".builder_elements");t.data("folded")||void 0==t.data("folded")?(t.data("folded",!1),t.removeClass("tcfa-caret-up").addClass("tcfa-caret-down"),i.removeClass("closed")):(t.data("folded",!0),t.removeClass("tcfa-caret-down").addClass("tcfa-caret-up"),i.addClass("closed")),e.tmEPOAdmin.fix_content_float()}),e(document).on("click",".tc-enable-responsive",function(){var t=e(this),i=t.find(".on"),n=t.find(".off"),a=e("#temp_for_floatbox_insert").find(".builder_responsive_div");t.is(".active")?(t.removeClass("active"),i.addClass("tm-hidden"),n.removeClass("tm-hidden"),a.hide()):(t.addClass("active"),i.removeClass("tm-hidden"),n.addClass("tm-hidden"),a.show())}),e(document).on("change.cpf",".tma-variations-section .sections_style",function(){e(this).val();e("#temp_for_floatbox_insert").find(".builder_hide_for_variations").hide(),e("#temp_for_floatbox_insert").find(".builder_hide_for_variation").hide()}),e().ajaxChosen&&e("select.ajax_chosen_select_tm_product_ids").ajaxChosen({method:"GET",url:tm_epo_admin.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products",security:tm_epo_admin.search_products_nonce}},function(t){var i={};return e.each(t,function(e,t){i[e]=t}),i}),e("body").on("woocommerce-product-type-change",function(){e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float();var t=e("#product-type");if(t.length){if("variable"==t.val()||"variable-subscription"==t.val());else{var i=e(".builder_layout .element-variations");i.length&&(i.closest(".builder_wrapper").remove(),e.tmEPOAdmin.builder_reorder_multiple(),e(".builder_layout .builder_wrapper").each(function(t,i){e.tmEPOAdmin.logic_init(e(i))}),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float(),e.tmEPOAdmin.toggle_variation_button(),e.tmEPOAdmin.var_remove("tm-style-variation-added"))}e.tmEPOAdmin.toggle_variation_button()}})},initialitize:function(){e.tmEPOAdmin.set_global_variation_object("initialitize_on")},initialitize_on:function(){e.tmEPOAdmin.isinit=!0,e.tmEPOAdmin.pre_element_logic_init_obj={},e.tmEPOAdmin.pre_element_logic_init_obj_options={},e.tmEPOAdmin.pre_element_logic_init(!0),e.tmEPOAdmin.pre_element_logic_init_done=!0,e.tmEPOAdmin.is_original=0==e(".tm-wmpl-disabled").length,e.tmEPOAdmin.current_edit_label=!1,e.tmEPOAdmin.toggle_variation_button(),e.tmEPOAdmin.is_original&&(e(".builder_layout").sortable({handle:".move",cursor:"move",items:".builder_wrapper:not(.tma-nomove)",start:function(e,t){t.placeholder.height(t.helper.outerHeight()),t.placeholder.width(t.helper.outerWidth())},stop:function(t,i){e.tmEPOAdmin.builder_reorder_multiple()},cancel:".tma-nomove",forcePlaceholderSize:!0,placeholder:"bitem pl2",forceHelperSize:!0,helper:"clone",tolerance:"pointer"}),e.tmEPOAdmin.builder_items_sortable(e(".builder_wrapper .bitem_wrapper")),e(".builder_elements .ditem").draggable({zIndex:5e3,scroll:!0,helper:"clone",start:function(t,i){e(t.target).css({opacity:.3}),e(".builder_layout .bitem_wrapper").not(".tma-variations-wrap .bitem_wrapper").addClass("highlight")},stop:function(t,i){e(".builder_layout .bitem_wrapper").removeClass("highlight"),e(t.target).css({opacity:1})},connectToSortable:".builder_layout .bitem_wrapper:not(.tma-nomove .bitem_wrapper)"})),e.tmEPOAdmin.add_events(),e.tmEPOAdmin.check_section_logic(),e.tmEPOAdmin.check_element_logic(),e.tmEPOAdmin.section_logic_start(),e.tmEPOAdmin.element_logic_start(),e.tmEPOAdmin.set_hidden(),e.tmEPOAdmin.set_fields_change(),e(document).on("change.cpf",".builder_textfield_price_type",function(){e.tmEPOAdmin.set_fields_change(e(this))}),e.tmEPOAdmin.set_field_title(),e(document).on("changetitle.cpf",".tm-header-title",function(){e.tmEPOAdmin.set_field_title(e(this))}),e(document).on("sections_type_onChange.cpf",".builder_wrapper",function(){e.tmEPOAdmin.sections_type_onChange(e(this))}),e(".builder_wrapper.tm-slider-wizard").each(function(){var t=e(this);e.tmEPOAdmin.create_slider(t)}),e("#taxonomy-product_cat").before(e("#tc_disabled_categories").removeClass("hidden")),e.tmEPOAdmin.disable_categories(),e(document).on("click.cpf",".meta-disable-categories",function(){e.tmEPOAdmin.disable_categories()}),e("#product_catdiv").before(e('<div class="tc-info-box hidden"></div>')),e(document).on("change.cpf",".product_page_tm-global-epo #product_catdiv input:checkbox, .product_page_tm-global-epo #tm_product_ids, .product_page_tm-global-epo #tm_enabled_options, .product_page_tm-global-epo #tm_disabled_options",function(){e.tmEPOAdmin.check_if_applied()}),e.tmEPOAdmin.check_if_applied(),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float(),e.tmEPOAdmin.fix_form_submit(),e.tmEPOAdmin.pre_element_logic_init_done=!1,e.tmEPOAdmin.isinit=!1},cpf_logic_element_onchange:function(t,i){var n=e(this);t instanceof jQuery&&(n=t),void 0===i&&(i=!(i=e(this).closest(".section_elements, .builder_wrapper, .bitem, .builder_element_wrap")).is(".section_elements")&&!i.is(".builder_wrapper"));var a;a=i?e.tmEPOAdmin.element_logic_object:e.tmEPOAdmin.logic_object;var l=n.val(),o=n.children("option:selected").attr("data-section"),d=n.children("option:selected").attr("data-type"),r=a;r=o in r&&(l in(r=a[o].values)&&a[o].values[l]);var s=n.closest(".tm-logic-rule").find(".tm-logic-value"),m=n.closest(".tm-logic-rule").find(".cpf-logic-operator");if(r){r=e(r);var c=m.val();s.empty().append(r),m.find("[value='is']").show(),m.find("[value='isnot']").show(),"variation"==d||"multiple"==d?("startswith"!=(c=m.val())&&"endswith"!=c&&"greaterthan"!=c&&"lessthan"!=c||m.val("isempty"),m.find("[value='startswith']").hide(),m.find("[value='endswith']").hide(),m.find("[value='greaterthan']").hide(),m.find("[value='lessthan']").hide(),m.trigger("change.cpf")):(m.find("[value='startswith']").show(),m.find("[value='endswith']").show(),m.find("[value='greaterthan']").show(),m.find("[value='lessthan']").show())}else l==o?("is"!=(c=m.val())&&"isnot"!=c&&"startswith"!=c&&"endswith"!=c&&"greaterthan"!=c&&"lessthan"!=c||m.val("isempty"),m.find("[value='is']").hide(),m.find("[value='isnot']").hide(),m.find("[value='startswith']").hide(),m.find("[value='endswith']").hide(),m.find("[value='greaterthan']").hide(),m.find("[value='lessthan']").hide(),m.trigger("change.cpf")):(m.find("[value='is']").show(),m.find("[value='isnot']").show(),m.find("[value='startswith']").show(),m.find("[value='endswith']").show(),m.find("[value='greaterthan']").show(),m.find("[value='lessthan']").show())},cpf_logic_operator_onchange:function(t,i){var n=e(this);t instanceof jQuery&&(n=t);var a=n.val(),l=n.closest(".tm-logic-rule").find(".tm-logic-value");"isempty"==a||"isnotempty"==a?l.hide():l.show()},create_slider:function(t){t.tmtabs({headers:".tm-slider-wizard-headers",header:".tm-slider-wizard-header",selectedtab:0,showonhover:function(){return e.tmEPOAdmin.is_element_dragged},useclasstohide:!0,afteraddtab:function(i,n){e.tmEPOAdmin.builder_items_sortable(n),t.find(".tm_builder_section_slides").val(function(i,n){return t.is(".tm-slider-wizard")?t.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""})},deletebutton:!0,deleteconfirm:!0,afterdeletetab:function(){t.find(".tm_builder_section_slides").val(function(i,n){return t.is(".tm-slider-wizard")?t.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),e.tmEPOAdmin.builder_reorder_multiple(),e(".builder_layout .builder_wrapper").each(function(t,i){e.tmEPOAdmin.logic_init(e(i))}),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float()}})},sections_type_onChange:function(t){var i=t.find(".bitem_wrapper"),n=t.find(".section_elements .sections_type").val();if("slider"!=n||t.hasClass("tm-slider-wizard"))"slider"!=n&&t.hasClass("tm-slider-wizard")&&(t.find(".bitem_wrapper").wrapAll('<div class="tmtemp"></div>'),t.find(".bitem_wrapper .bitem").appendTo(t.find(".tmtemp")),t.find(".bitem_wrapper").remove(),t.find(".tmtemp").addClass("bitem_wrapper").removeClass("tmtemp"),e.tmEPOAdmin.builder_items_sortable(t.find(".bitem_wrapper")),t.find(".tm-slider-wizard-headers").remove(),t.removeClass("tm-slider-wizard"),t.find(".tm_builder_section_slides").val(""));else{t.addClass("tm-slider-wizard");i.before('<div class="transition tm-slider-wizard-headers"><div class="tm-box"><h4 class="tm-slider-wizard-header" data-id="tm-slide0">1</h4></div><div class="tm-box tm-add-box"><h4 class="tm-add-tab"><span class="tcfa tcfa-plus"></span></h4></div></div>'),i.addClass("tm-slider-wizard-tab tm-slide0"),e.tmEPOAdmin.create_slider(t),t.find(".tm_builder_section_slides").val(function(i,n){return t.is(".tm-slider-wizard")?t.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""})}},variation_events_success:function(t,i,n){setTimeout(function(){e.tmEPOAdmin.set_global_variation_object("reindex")},600),e(document).unbind("ajaxSuccess",e.tmEPOAdmin.variation_events_success),e.tmEPOAdmin.var_remove("tma-remove_variation-added")},tm_variations_check_events_success:function(t,i,n){setTimeout(function(){e.tmEPOAdmin.tm_variations_check_for_changes=1,e.tmEPOAdmin.tm_variations_check()},600),e(document).unbind("ajaxSuccess",e.tmEPOAdmin.tm_variations_check_events_success),e.tmEPOAdmin.var_remove("tma-remove_variation-added")},add_variation_events:function(){!0!==e.tmEPOAdmin.var_is("tma-variation-events-added")&&(!0!==e.tmEPOAdmin.var_is("tma-remove_variation-added")&&e("#variable_product_options").on("click.tma",".remove_variation",function(t){e(document).ajaxSuccess(e.tmEPOAdmin.variation_events_success),e.tmEPOAdmin.var_is("tma-remove_variation-added",!0),e(document).ajaxSuccess(e.tmEPOAdmin.tm_variations_check_events_success)}),!0!==e.tmEPOAdmin.var_is("tma-remove_variation-added")&&e(".wc-metaboxes-wrapper").on("click","a.bulk_edit",function(t){"delete_all"==e("select#field_to_edit").val()&&(e(document).ajaxSuccess(e.tmEPOAdmin.variation_events_success),e.tmEPOAdmin.var_is("tma-remove_variation-added",!0),e(document).ajaxSuccess(e.tmEPOAdmin.tm_variations_check_events_success))}),e("#variable_product_options").on("woocommerce_variations_added",function(){e.tmEPOAdmin.set_global_variation_object("reindex"),e(document).ajaxSuccess(e.tmEPOAdmin.tm_variations_check_events_success)}),e("#woocommerce-product-data").on("woocommerce_variations_saved",function(){e.tmEPOAdmin.set_global_variation_object("reindex"),e(document).ajaxSuccess(e.tmEPOAdmin.tm_variations_check_events_success)}),e(document).on("click.cpf",".save_attributes",function(t){e(document).ajaxSuccess(e.tmEPOAdmin.tm_variations_check_events_success)}),e.tmEPOAdmin.var_is("tma-variation-events-added",!0))},toggle_variation_button:function(){var t=e("#product-type");if(t.length)if("variable"==t.val()||"variable-subscription"==t.val()){e(".builder_add_section").addClass("inline"),e(".builder_add_variation").addClass("inline").removeClass("tm-hidden"),e.tmEPOAdmin.add_variation_events();var i=e(".builder_layout .element-variations");if(i.length){var n=i.closest(".builder_wrapper");n.find(".tm-add-element-action,.tmicon.clone,.tmicon.size,.tmicon.move,.tmicon.plus,.tmicon.minus").remove(),n.addClass("tma-nomove tma-variations-wrap"),n.find(".builder_hide_for_variation").hide();var a=n.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce");a.hide(),e.tmEPOAdmin.var_is("tm-style-variation-added",!0),i.addClass("tma-nomove"),i.find(".tmicon.size,.tmicon.clone,.tmicon.move,.tmicon.plus,.tmicon.minus,.tmicon.delete").remove(),(a=i.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce")).remove(),e(".builder_add_section").removeClass("inline"),e(".builder_add_variation").removeClass("inline").addClass("tm-hidden")}}else e(".builder_add_section").removeClass("inline"),e(".builder_add_variation").removeClass("inline").addClass("tm-hidden")},can_take_logic:function(){return".element-color,.element-range,.element-radiobuttons,.element-checkboxes,.element-selectbox,.element-textfield,.element-textarea,.element-variations"},prepare_for_json:function(t){var i,n,a,l={};for(var o in t)0==o.indexOf("tm_meta[")&&((i=o.split(/[[\]]{1,2}/)).pop(),a=(i=i.map(function(e){return""===e?null:e})).length>0&&null==i[i.length-1],i=i.filter(function(e,t,i){if(null!==e&&void 0!==e)return e}),n="object"!=typeof t[o]&&a?[t[o]]:t[o],l=e.tmEPOAdmin.constructObject(i,n,l));return l},constructObject:function(t,i,n){var a=t.shift();return t.length>0?(n.hasOwnProperty(a)||(n[a]={}),n[a]=e.tmEPOAdmin.constructObject(t,i,n[a])):n[a]=i,n},fix_form_submit:function(){e("#post").submit(function(){var t,i,n,a,l=e("input#wp-preview");return t=e(this).find('[name^="tm_meta["]'),e(".tm_meta_serialized").remove(),e(".tm_meta_serialized_wpml").remove(),t.attr("disabled",!1),e.tmEPOAdmin.is_original?(i=e.tmEPOAdmin.prepare_for_json(e(this).tm_serializeObject()),i=e.tmEPOAdmin.tm_escape(e.toJSON(i)),a=e("<textarea class='tm_meta_serialized tm-hidden' name='tm_meta_serialized'></textarea>").val(i),e(this).prepend(a)):(n=e.tmEPOAdmin.prepare_for_json(e(this).tm_serializeObject()),n=e.tmEPOAdmin.tm_escape(e.toJSON(n)),a=e("<textarea class='tm_meta_serialized tm-hidden' name='tm_meta_serialized_wpml'></textarea>").val(n),e(this).prepend(a)),t.attr("disabled","disabled"),l.length>0&&""!=l.val()&&(t.not(".tm-wmpl-disabled").attr("disabled",!1),e(".tm_meta_serialized").remove()),!0})},init_sections_check:function(){e(".builder_wrapper").length?(e(".builder_elements").show(),e(".builder-add-section-action").show(),e(".builder_selector").show(),e(".tc-welcome").hide()):(e(".builder_elements").hide(),e(".builder-add-section-action").hide(),e(".builder_selector").hide(),e(".tc-welcome").show())},fix_content_float:function(){var t;t=e(".builder_elements").is(":hidden")?0:e(".builder_elements").outerHeight(),e("#wpcontent").css("margin-bottom",t+"px")},disable_categories:function(t){e(".meta-disable-categories").is(":checked")?e("#taxonomy-product_cat").slideUp():e("#taxonomy-product_cat").slideDown()},check_if_applied:function(t){if(e("body").is(".product_page_tm-global-epo")){var i=e("#tm_meta_disable_categories:checked").length>0,n=e("#product_catdiv input:checkbox").not(e("#tm_meta_disable_categories")).filter(":checked").length>0,a=e("#tm_product_ids").val(),l=e("#tm_enabled_options").val(),o=e("#tm_disabled_options").val();a=!(!a||null===a)&&a.length>0,l=!(!l||null===l)&&l.length>0,o=!(!o||null===o)&&o.length>0,i?a||l||o?e(".tc-info-box").removeClass("tc-error tc-all-products").addClass("hidden").html(""):e(".tc-info-box").removeClass("hidden tc-all-products").addClass("tc-error").html(tm_epo_admin.i18n_form_not_applied_to_all):n?e(".tc-info-box").removeClass("tc-error tc-all-products").addClass("hidden").html(""):e(".tc-info-box").removeClass("hidden error").addClass("tc-all-products").html(tm_epo_admin.i18n_form_is_applied_to_all)}},check_section_logic:function(t){!t&&e.tmEPOAdmin.isinit&&e.tmEPOAdmin.done_check_section_logic||(t||(t=e("#tmformfieldsbuilderwrap").find("div.builder_wrapper")),t.each(function(t,i){var n=e(i),a=n.find(".tm-builder-sections-uniqid").val();a&&""!==a&&void 0!==a&&!1!==a||n.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0)),1==parseInt(n.find(".activate-sections-logic").val())?n.find(".builder-logic-div").show():n.find(".builder-logic-div").hide()}),e.tmEPOAdmin.done_check_section_logic=!0)},check_element_logic:function(t){if(t||!e.tmEPOAdmin.isinit||!e.tmEPOAdmin.done_check_section_logic){var i=[],n=!1;t||(t=e("#tmformfieldsbuilderwrap").find("div.bitem"),n=!0),t.each(function(t,a){var l=(a=e(a)).find(".tm-builder-element-uniqid").val();(n&&-1!==i.indexOf(l)||!l||""===l||void 0===l||!1===l)&&a.find(".tm-builder-element-uniqid").val(e.tm_uniqid("",!0)),n&&i.push(a.find(".tm-builder-element-uniqid").val()),1==parseInt(a.find(".activate-element-logic").val())?a.find(".builder-logic-div").show():a.find(".builder-logic-div").hide()}),e.tmEPOAdmin.done_check_section_logic=!0}},section_logic_start:function(t){t||(t=e(".builder_layout .builder_wrapper")),t.each(function(t,i){i=e(i),e.tmEPOAdmin.logic_init(i);try{var n=i.find(".section_elements .tm-builder-clogic").val()||"null";n=n.tmparseJSON(),n=e.tmEPOAdmin.logic_check_section_rules(n),i.find(".section_elements .tm-builder-clogic").val(JSON.stringify(n)),i.find(".section_elements .epo-rule-toggle").val(n.toggle),i.find(".section_elements .epo-rule-what").val(n.what)}catch(e){}})},element_logic_start:function(t){t||(t=e(".builder_layout .builder_wrapper .bitem")),t.each(function(t,i){i=e(i),e.tmEPOAdmin.element_logic_init(i);try{var n=i.find(".tm-builder-clogic").val()||"null";n=n.tmparseJSON(),n=e.tmEPOAdmin.logic_check_element_rules(n),i.find(".tm-builder-clogic").val(JSON.stringify(n)),i.find(".epo-rule-toggle").val(n.toggle),i.find(".epo-rule-what").val(n.what)}catch(e){}})},panels_reorder:function(t){e(t).children(".options_wrap").each(function(t,i){e(i).find(".tm-default-radio,.tm-default-checkbox").val(t)})},panels_sortable:function(t){0!=e(t).length&&e.tmEPOAdmin.is_original&&t.not(e(".builder_elements .panels_wrap")).sortable({cursor:"move",tolerance:"pointer",forcePlaceholderSize:!0,placeholder:"panel_wrap pl",stop:function(t,i){e.tmEPOAdmin.panels_reorder(e(i.item).closest(".panels_wrap"))}})},builder_panel_delete_all_onClick:function(t){t.preventDefault(),e(this).trigger("hideTtooltip");var i=e(this).closest(".panels_wrap"),n=e(".flasho.tm_wrapper").find(".panels_wrap");if(n.children().length>1){var a=n.find(".options_wrap");a.each(function(t){if(0==t)return!0;e(this).remove(),n.find(".numorder").each(function(t,i){e(this).html(t+1)})}),a.find("input").val(""),e.tmEPOAdmin.panels_reorder(i)}},builder_panel_delete_onClick:function(t){t.preventDefault(),e(this).trigger("hideTtooltip");var i=e(this).closest(".panels_wrap");i.children().length>1&&e(this).closest(".options_wrap").css({margin:"0 auto"}).animate({opacity:0,height:0,width:0},300,function(){e(this).remove(),i.find(".numorder").each(function(t,i){e(this).html(t+1)}),i.children(".options_wrap").each(function(t,i){e(this).find("[id]").each(function(i,n){var a=e(this).attr("name").replace(/[\[\]]/g,"");e(this).attr("id",a+"_"+t)})}),e.tmEPOAdmin.panels_reorder(i)})},builder_panel_mass_add_onClick:function(t){if(t.preventDefault(),!e(this).is(".disabled")){e(this).addClass("disabled");var i='<div class="tm-panel-populate-wrapper"><textarea class="tm-panel-populate"></textarea><button type="button" class="tc tc-button builder-panel-populate">'+tm_epo_admin.i18n_populate+"</button></div>";e(this).after(i)}},builder_panel_populate_onClick:function(t){t.preventDefault(),e(this).remove();for(var i=e(".flasho.tm_wrapper").find(".panels_wrap"),n=i.children(),a=e(""),l=e(".tm-panel-populate").val().split(/\n/),o=[],d=0;d<l.length;d++)/\S/.test(l[d])&&o.push(e.trim(l[d]));for(d=0;d<o.length;d++){var r=o[d].split("|"),s=r.length;if(0!=s){1==s&&(r[1]=0),r[0]=e.trim(r[0]),r[1]=parseFloat(e.trim(r[1])),isNaN(r[1])&&(r[1]="");var m=e.tmEPOAdmin.add_panel_row(r,i,n);a=a.add(m)}}a.length&&(i.append(a),e.tm_tooltip(a.find(".tm-tooltip"))),e(".builder-panel-mass-add").removeClass("disabled"),e(".tm-panel-populate-wrapper").remove(),e.tmEPOAdmin.paginattion_init("last")},add_panel_row:function(t,i,n){var a=n.last().tm_clone();return a?(e.tmEPOAdmin.builder_clone_after_events(a),e.tmEPOAdmin.gen_events(a),a.find("[name]").val(""),a.find("[id]").each(function(t,i){var a=e(this).attr("name").replace(/[\[\]]/g,""),l=n.length;e(this).attr("id",a+"_"+l)}),a.find(".tm_option_title").val(t[0]),a.find(".tm_option_value").val(t[0]),a.find(".tm_option_price").val(t[1]),t[2]&&(a.find(".tm_option_price_type").val(t[2]),null==a.find(".tm_option_price_type").val()&&a.find(".tm_option_price_type").val("")),t[3]&&(a.find(".tm_option_description").val(t[3]),null==a.find(".tm_option_description").val()&&a.find(".tm_option_description").val("")),a.find(".numorder").html(parseInt(parseInt(n.length)+1)),a.find(".tm_upload_image img").attr("src",""),a.find("input.tm_option_image").val(""),a.find(".tm-default-radio,.tm-default-checkbox").removeAttr("checked").prop("checked",!1).val(n.length),a):e("")},builder_panel_add_onClick:function(t){t.preventDefault();var i=e(this).prev(".panels_wrap").children(),n=i.last().tm_clone();n&&(e.tmEPOAdmin.builder_clone_after_events(n),e.tmEPOAdmin.gen_events(n),n.find("[name]").val(""),n.find("[id]").each(function(t,n){var a=e(this).attr("name").replace(/[\[\]]/g,""),l=i.length;e(this).attr("id",a+"_"+l)}),n.find(".numorder").html(parseInt(parseInt(i.length)+1)),n.find(".tm_upload_image img").attr("src",""),n.find("input.tm_option_image").val(""),n.find(".tm-default-radio,.tm-default-checkbox").removeAttr("checked").prop("checked",!1).val(i.length),e(this).prev(".panels_wrap").append(n),e.tm_tooltip(n.find(".tm-tooltip")),e.tmEPOAdmin.paginattion_init("last"),e.tmEPOAdmin.tm_upload())},builder_add_section_onClick:function(t,i){t&&t.preventDefault();var n=e.fn.tm_template(p.tc_builder_section,{});if(n){var a=e(n);if(a)return a.addClass("w100"),a.addClass("appear"),a.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0)),i?a.appendTo(".builder_layout"):a.prependTo(".builder_layout"),e.tmEPOAdmin.gen_events(a),a.find(".tm-tabs").tmtabs(),e.tmEPOAdmin.check_section_logic(a),e.tmEPOAdmin.logic_init(a),e.tmEPOAdmin.builder_items_sortable(a.find(".bitem_wrapper")),e.tmEPOAdmin.builder_reorder_multiple(),e(this).is("a")&&e(window).tc_scrollTo(a),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float(),a}return!1},builder_add_element_onClick:function(t){t&&t.preventDefault();var i=e(this),n=e.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+tm_epo_admin.element_data+"</div>",title:tm_epo_admin.i18n_add_element}),a=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!1,refresh:"fixed",width:"70%",height:"70%",top:"15%",left:"15%",classname:"flasho tm_wrapper tc-builder-add-element",data:n});e("#flasho .details_cancel").click(function(){a&&a.cancelfunc()}),e(".tc-builder-add-element .tc-element-button").on("click.cpf",function(t){t.preventDefault();var n=i.closest(".builder_wrapper"),a=e(this).attr("data-element");i.is(".tc-prepend")?e.tmEPOAdmin.builder_clone_element(a,n,"prepend"):e.tmEPOAdmin.builder_clone_element(a,n),e.tmEPOAdmin.logic_reindex(),e("#flasho .details_cancel").trigger("click")})},builder_add_section_and_element_onClick:function(t){t&&t.preventDefault();var i=e.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+tm_epo_admin.element_data+"</div>",title:tm_epo_admin.i18n_add_element}),n=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!1,refresh:"fixed",width:"70%",height:"70%",top:"15%",left:"15%",classname:"flasho tm_wrapper tc-builder-add-section-and-element",data:i});e("#flasho .details_cancel").click(function(){n&&n.cancelfunc()}),e(".tc-builder-add-section-and-element .tc-element-button").on("click.cpf",function(t){t.preventDefault();var i=e.tmEPOAdmin.builder_add_section_onClick(!1,!0);if(i){var n=e(this).attr("data-element");e.tmEPOAdmin.builder_clone_element(n,i),e.tmEPOAdmin.logic_reindex(),e("#flasho .details_cancel").trigger("click")}})},tm_variations_check_for_changes:0,tm_variations_check:function(){if(e(".builder_layout .element-variations").length){if(void 0===t&&"undefined"!=typeof tm_epo_admin_meta_boxes)var t=tm_epo_admin_meta_boxes;if(1==e.tmEPOAdmin.tm_variations_check_for_changes&&void 0!==t){e("#tm_extra_product_options").block({message:null,overlayCSS:{background:"#fff url("+t.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var i={action:"woocommerce_tm_variations_check",post_id:t.post_id,security:t.check_attributes_nonce};e.post(t.ajax_url,i,function(t){e(".tma-variations-wrap .tm-all-attributes").html(t),e("#tm_extra_product_options").unblock(),e("#tm_extra_product_options").trigger("woocommerce_tm_variations_check_loaded"),e.tmEPOAdmin.tm_variations_check_for_changes=0,e.tmEPOAdmin.builder_reorder_multiple()})}}},builder_add_variation_onClick:function(t){if(t&&t.preventDefault(),!0!==e.tmEPOAdmin.var_is("tm-style-variation-added")){var i=e.fn.tm_template(p.tc_builder_section,{});if(i){var n=e(i);if(n){n.addClass("w100"),n.addClass("appear"),n.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0)),n.find(".tm-add-element-action,.tmicon.clone,.tmicon.size,.tmicon.move,.tmicon.plus,.tmicon.minus").remove(),n.addClass("tma-nomove tma-variations-wrap"),n.find(".builder_hide_for_variation").hide();var a=n.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce");a.hide(),n.prependTo(".builder_layout"),e.tmEPOAdmin.gen_events(n),n.find(".tm-tabs").tmtabs(),e.tmEPOAdmin.check_section_logic(n),e.tmEPOAdmin.logic_init(n),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float(),e.tmEPOAdmin.var_is("tm-style-variation-added",!0),e(".builder_add_variation").addClass("tm-hidden"),e(".builder_add_section").removeClass("inline");var l=e.tmEPOAdmin.builder_clone_element("variations",e(".builder_layout").find(".builder_wrapper").first());l.find(".tmicon.size,.tmicon.clone,.tmicon.move,.tmicon.plus,.tmicon.minus,.tmicon.delete").remove(),a=l.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce"),l.addClass("tma-nomove"),l.find(".builder_hide_for_variation").hide(),a.hide(),e.tmEPOAdmin.logic_reindex_force(),e.tmEPOAdmin.tm_variations_check_for_changes=1,e.tmEPOAdmin.tm_variations_check()}}}},var_is:function(t,i){return i?void e("body").data(t,i):e("body").data(t)},var_remove:function(t){t&&e("body").removeData(t)},element_logic_object:{},logic_object:{},logic_operators:{is:tm_epo_admin.i18n_is,isnot:tm_epo_admin.i18n_is_not,isempty:tm_epo_admin.i18n_is_empty,isnotempty:tm_epo_admin.i18n_is_not_empty,startswith:tm_epo_admin.i18n_starts_with,endswith:tm_epo_admin.i18n_ends_with,greaterthan:tm_epo_admin.i18n_greater_than,lessthan:tm_epo_admin.i18n_less_than},tm_escape:function(e){return encodeURIComponent(e)},tm_unescape:function(e){return decodeURIComponent(e)},get_element_logic_init:function(t){return e.tmEPOAdmin.pre_element_logic_init_done||e.tmEPOAdmin.pre_element_logic_init(t),e.tmEPOAdmin.isinit?e.tmEPOAdmin.pre_element_logic_init_done=!0:e.tmEPOAdmin.pre_element_logic_init_done=!1,e.tmEPOAdmin.pre_element_logic_init_obj},get_element_logic_options_init:function(t){return e.tmEPOAdmin.pre_element_logic_init_done||e.tmEPOAdmin.pre_element_logic_init(t),e.tmEPOAdmin.isinit?e.tmEPOAdmin.pre_element_logic_init_done=!0:e.tmEPOAdmin.pre_element_logic_init_done=!1,e.tmEPOAdmin.pre_element_logic_init_obj_options},find_index:function(e,t,i,n){var a=0;return e&&(a=t.closest(".bitem_wrapper").prevAll(".bitem_wrapper").find(".bitem").length),i&&n?a+t.parent().find(i).not(n).index(t):a+t.index()},set_global_variation_object:function(t,i){if(void 0===n&&"undefined"!=typeof tm_epo_admin_meta_boxes)var n=tm_epo_admin_meta_boxes;if(n){e("#tm_extra_product_options").block({message:null,overlayCSS:{background:"#fff url("+n.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var a={action:"woocommerce_tm_get_variations_array",post_id:n.post_id,security:n.check_attributes_nonce},l=window.ajaxurl||n.ajax_url;e.post(l,a,function(n){n&&(u=n,!0===t?e.tmEPOAdmin.pre_element_logic_init_set(i):"reindex"==t?e.tmEPOAdmin.logic_reindex_force():"initialitize_on"==t&&e.tmEPOAdmin.initialitize_on())},"json").always(function(t){e("#tm_extra_product_options").unblock()})}else"initialitize_on"==t&&(u||(u={}),e.tmEPOAdmin.initialitize_on())},pre_element_logic_init:function(t){u?e.tmEPOAdmin.pre_element_logic_init_set(t):e.tmEPOAdmin.set_global_variation_object(!0,t)},pre_element_logic_init_set:function(t){if(u){e.tmEPOAdmin.pre_element_logic_init_obj={},e.tmEPOAdmin.pre_element_logic_init_obj_options={};var i={},n={},a=[];e(".builder_layout .builder_wrapper").each(function(l,o){var d=(o=e(o)).find(".tm-builder-sections-uniqid").val();-1!=a.indexOf(d)&&(o.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0)),d=o.find(".tm-builder-sections-uniqid").val()),a.push(d),i[d]=[],t&&e.tmEPOAdmin.check_section_logic(o);var r=o.find(".tm-internal-name").val()||"Section";o.is(".tma-variations-wrap")||(i[d][0]='<option data-type="section" data-section="'+d+'" value="'+d+'">'+r+" ("+d+")</option>");var s=o.find(e.tmEPOAdmin.can_take_logic()).not(".element_is_disabled"),m=[],c=o.is(".tm-slider-wizard");s.each(function(t,n){var a=(n=e(n)).find('[name^="tm_meta\\[tmfbuilder\\]\\["][name$="_header_title\\]\\[\\]"]'),l=e.tmEPOAdmin.find_index(c,n,".bitem",".element_is_disabled"),o=n.find(".is_enabled"),r=1==n.find(".is_enabled").val();if(o.length&&!r)return!0;if(1==a.length){var s=a.val();0==s.length&&(s=a.closest(".bitem").find(".tm-label").text());var _=a.closest(".bitem").find(".tm-internal-name").val();_!=s&&(s=s+" ("+_+")");var p=n.is(".element-variations")?"variation":n.is(".element-radiobuttons,.element-checkboxes,.element-selectbox")?"multiple":"text";if(i[d][l+1]='<option data-type="'+p+'" data-section="'+d+'" value="'+l+'">'+s+"</option>",n.is(".element-variations")){var f,v=[];e(u.variations).each(function(t,i){f=[],e(i.attributes).each(function(t,i){var n=e.map(i,function(e){return e});e(n).each(function(e,t){f.push(t)})});var n=f=f.join(" - ");try{n=e.tmEPOAdmin.tm_unescape(f)}catch(e){}v.push('<option value="'+e.tmEPOAdmin.tm_escape(i.variation_id)+'">'+n+"</option>")}),m[l]='<select data-element="'+l+'" data-section="'+d+'" class="cpf-logic-value">'+v.join("")+"</select>"}else if(n.is(".element-radiobuttons,.element-checkboxes,.element-selectbox")){var b=n.find(".tm_option_title"),h=n.find(".tm_option_value"),v=[];b.each(function(t,i){v.push('<option value="'+e.tmEPOAdmin.tm_escape(e(h[t]).val())+'">'+e(i).val()+"</option>")}),m[l]='<select data-element="'+l+'" data-section="'+d+'" class="cpf-logic-value">'+v.join("")+"</select>"}else m[l]='<input data-element="'+l+'" data-section="'+d+'" class="cpf-logic-value" type="text" value="">'}}),n[d]={values:m}}),e.tmEPOAdmin.pre_element_logic_init_obj=n,e.tmEPOAdmin.pre_element_logic_init_obj_options=i}},element_logic_init:function(t){var i=e(t),n=i.closest(".builder_wrapper").is(".tm-slider-wizard"),a=e.tmEPOAdmin.find_index(n,i,".bitem",".element_is_disabled");e.tmEPOAdmin.check_section_logic(),e.tmEPOAdmin.check_element_logic(i);var l=e.extend(!0,{},e.tmEPOAdmin.get_element_logic_init()),o=e.extend(!0,{},e.tmEPOAdmin.get_element_logic_options_init()),d=[],r=i.closest(".builder_layout .builder_wrapper"),s=r.find(".tm-builder-sections-uniqid").val();r&&s&&l[s]&&l[s].values[a]?(delete l[s].values[a],delete o[s][a+1],delete o[s][0]):r&&s&&o[s]&&o[s][0]&&delete o[s][0],e.each(o,function(t,i){i&&e.each(i,function(e,t){t&&d.push(t)})}),e.tmEPOAdmin.element_logic_object.init||(e.tmEPOAdmin.element_logic_object.init=!0),e.tmEPOAdmin.element_logic_object=e.extend(e.tmEPOAdmin.element_logic_object,l),e.tmEPOAdmin.logic_append(t,d)},logic_init:function(t){t=e(t),e.tmEPOAdmin.check_section_logic(t);var i=[],n={},n=e.extend(!0,{},e.tmEPOAdmin.get_element_logic_init(!0)),a=e.extend(!0,{},e.tmEPOAdmin.get_element_logic_options_init(!0)),i=[],l=t.find(".tm-builder-sections-uniqid").val();t&&l&&n[l]&&(delete n[l],delete a[l]),e.each(a,function(t,n){n&&e.each(n,function(e,t){t&&i.push(t)})}),e.tmEPOAdmin.logic_object.init||(e.tmEPOAdmin.logic_object.init=!0),e.tmEPOAdmin.logic_object=e.extend(e.tmEPOAdmin.logic_object,n),e.tmEPOAdmin.logic_append(t,i)},logic_check_section_rules:function(t){"object"==typeof t&&null!==t||(t={}),"toggle"in t||(t.toggle="show"),"what"in t||(t.what="any"),"rules"in t||(t.rules=[]);var i=t,n=e.tmEPOAdmin.logic_object;return e.each(t.rules,function(e,t){var a=t.section,l=t.element;a in n&&l in n[a].values||(a=l)||delete i.rules[e]}),i.rules=e.tm_array_values(i.rules),i},logic_check_element_rules:function(t){"object"==typeof t&&null!==t||(t={}),"toggle"in t||(t.toggle="show"),"what"in t||(t.what="any"),"rules"in t||(t.rules=[]);var i=t,n=e.tmEPOAdmin.element_logic_object;return e.each(t.rules,function(e,t){var a=t.section,l=t.element;a in n&&l in n[a].values||(a=l)||delete i.rules[e]}),i.rules=e.tm_array_values(i.rules),i},logic_append:function(t,i){var n;n=(t=e(t)).is(".bitem")?t.find(".builder_element_wrap"):t.find(".section_elements");var a=e(n).find(".tm-logic-wrapper");if(!i||0==i.length)return a.html('<div class="errortitle"><p>'+tm_epo_admin.i18n_cannot_apply_rules+"</p></div>"),!1;var l;try{var o=(e(n).find(".tm-builder-clogic").val()||"null").tmparseJSON();l=t.is(".bitem")?e.tmEPOAdmin.logic_check_element_rules(o):e.tmEPOAdmin.logic_check_section_rules(o),e(n).find(".tm-builder-clogic").val(JSON.stringify(l))}catch(e){}a.empty();var d="",r=e(d='<div class="tm-row nopadding tm-logic-rule"><div class="tm-cell col-4 tm-logic-element"></div><div class="tm-cell col-2 tm-logic-operator"></div><div class="tm-cell col-4 tm-logic-value"></div><div class="tm-cell col-2 tm-logic-func"><button type="button" class="tc tc-button cpf-add-rule"><i class="tcfa tcfa-plus"></i></button> <button type="button" class="tc tc-button cpf-delete-rule"><i class="tcfa tcfa-times"></i></button></div></div>'),s=e('<select class="cpf-logic-element">'+i.join("")+"</select>"),m="";for(var c in e.tmEPOAdmin.logic_operators)m=m+'<option value="'+c+'">'+e.tmEPOAdmin.logic_operators[c]+"</option>";if(m=e('<select class="cpf-logic-operator">'+m+"</select>"),r.find(".tm-logic-element").append(s),r.find(".tm-logic-operator").append(m),l&&"rules"in l&&l.rules.length){var _=e('<div class="temp">');e.each(l.rules,function(i,n){if("function"!=typeof n&&null!=n){var a=r.clone(),l=a.find(".cpf-logic-element").find('option[data-section="'+n.section+'"][value="'+n.element+'"]');e(l).length&&(e(l)[0].selected=!0),e.tmEPOAdmin.cpf_logic_element_onchange(a.find(".cpf-logic-element"),t.is(".bitem")),a.find(".cpf-logic-operator").val(n.operator),e.tmEPOAdmin.cpf_logic_operator_onchange(a.find(".cpf-logic-operator"),t.is(".bitem")),a.find(".cpf-logic-value").is("select")?a.find(".cpf-logic-value").val(e.tmEPOAdmin.tm_escape(e.tmEPOAdmin.tm_unescape(n.value))):a.find(".cpf-logic-value").val(e.tmEPOAdmin.tm_unescape(n.value)),_.append(a)}}),_=_.children(),a.append(_)}else r.appendTo(a).find(".cpf-logic-element").trigger("change.cpf",[t.is(".bitem")]),r.appendTo(a).find(".cpf-logic-operator").trigger("change.cpf",[t.is(".bitem")])},logic_get_JSON:function(t){var i=e(t).find(".builder-logic-div"),n=t.find(".tm-builder-sections-uniqid").val(),a={},l=i.find(".epo-rule-toggle").val(),o=i.find(".epo-rule-what").val();return a.section=n,a.toggle=l,a.what=o,a.rules=[],i.find(".tm-logic-wrapper").children(".tm-logic-rule").each(function(t,i){var n=(i=e(i)).find(".cpf-logic-element"),l=n.children("option:selected").attr("data-section"),o=n.val(),d=i.find(".cpf-logic-operator").val(),r=i.find(".cpf-logic-value").val();i.find(".cpf-logic-value").is("select")||(r=e.tmEPOAdmin.tm_escape(r)),a.rules.push({section:l,element:o,operator:d,value:r})}),JSON.stringify(a)},element_logic_get_JSON:function(t){var i=e(t).find(".builder-logic-div"),n=t.find(".tm-builder-element-uniqid").val(),a={},l=i.find(".epo-rule-toggle").val(),o=i.find(".epo-rule-what").val();return a.element=n,a.toggle=l,a.what=o,a.rules=[],i.find(".tm-logic-wrapper").children(".tm-logic-rule").each(function(t,i){var n=(i=e(i)).find(".cpf-logic-element"),l=n.children("option:selected").attr("data-section"),o=n.val(),d=i.find(".cpf-logic-operator").val(),r=i.find(".cpf-logic-value").val();a.rules.push({section:l,element:o,operator:d,value:r})}),JSON.stringify(a)},cpf_add_rule:function(t){t.preventDefault();var i=e(this).closest(".tm-logic-rule"),n=i.tm_clone(!0);n&&i.after(n)},cpf_delete_rule:function(t){t.preventDefault(),e(this).trigger("hideTtooltip"),e(this).closest(".tm-logic-wrapper").children().length>1&&e(this).closest(".tm-logic-rule").css({margin:"0 auto"}).animate({opacity:0,height:0,width:0},300,function(){e(this).remove()})},builder_items_sortable_obj:{start:{},end:{}},section_logic_reindex:function(){var t=e.tmEPOAdmin.builder_items_sortable_obj;e(".builder_layout .builder_wrapper").each(function(i,n){var a=e(n).find(".section_elements"),l=e(n).index(),o=[],d=e(a).find(".tm-builder-clogic").val()||"null";if(!((d=d.tmparseJSON())&&"rules"in d&&d.rules.length>0))return!0;t.end.section_eq==l?(e.each(d.rules,function(i,a){var l=a;a.element==t.start.element&&a.section==t.start.section||(a.element>t.start.element&&a.secion==t.start.section?(l.element=parseInt(l.element)-1,o[i]=e.tmEPOAdmin.validate_rule(l,e(n))):o[i]=e.tmEPOAdmin.validate_rule(l,e(n)))}),0==(o=e.tm_array_values(o)).length&&e(a).find(".activate-sections-logic").val("").trigger("change.cpf"),d.rules=o,e(a).find(".tm-builder-clogic").val(JSON.stringify(d))):(e.each(d.rules,function(i,a){var l=a;"check"!=t.start.section&&(a.section==t.start.section&&a.section==t.end.section?a.element==t.start.element?(l.section=t.end.section,l.element=t.end.element):a.element>t.start.element&&a.element<=t.end.element?l.element=parseInt(l.element)-1:a.element<t.start.element&&a.element>=t.end.element&&(l.element=parseInt(l.element)+1):a.section==t.start.section&&a.section!=t.end.section?a.element==t.start.element?(l.section=t.end.section,l.element=t.end.element):a.element>t.start.element&&(l.element=parseInt(l.element)-1):a.section!=t.start.section&&a.section==t.end.section&&a.element>=t.end.element&&(l.element=parseInt(l.element)+1)),"delete"==t.end.section&&"delete"==l.element||(o[i]=e.tmEPOAdmin.validate_rule(l,e(n)))}),0==(o=e.tm_array_values(o)).length&&e(a).find(".activate-sections-logic").val("").trigger("change.cpf"),d.rules=o,e(a).find(".tm-builder-clogic").val(JSON.stringify(d)))})},element_logic_reindex:function(){var t=e.tmEPOAdmin.builder_items_sortable_obj;e(".bitem").each(function(i,n){var a=e(n).find(".builder_element_wrap"),l=[],o=e(a).find(".tm-builder-clogic").val()||"null";if(!((o=o.tmparseJSON())&&"rules"in o&&o.rules.length>0))return!0;e.each(o.rules,function(i,a){var o=a;"check"!=t.start.section&&(a.section==t.start.section&&a.section==t.end.section?a.element==t.start.element?o.element=t.end.element:a.element>t.start.element&&a.element<=t.end.element?o.element=parseInt(o.element)-1:a.element<t.start.element&&a.element>=t.end.element&&(o.element=parseInt(o.element)+1):a.section==t.start.section&&a.section!=t.end.section?a.element==t.start.element?(o.section=t.end.section,o.element=t.end.element):a.element>t.start.element&&(o.element=parseInt(o.element)-1):a.section!=t.start.section&&a.section==t.end.section&&a.element>=t.end.element&&(o.element=parseInt(o.element)+1)),"delete"==t.end.section&&"delete"==o.element||(l[i]=e.tmEPOAdmin.validate_rule(o,e(n)))}),0==(l=e.tm_array_values(l)).length&&e(a).find(".activate-element-logic").val("").trigger("change.cpf"),o.rules=l,e(a).find(".tm-builder-clogic").val(JSON.stringify(o))})},validate_rule:function(t,i){if(u&&t&&"object"==typeof t&&"element"in t&&"operator"in t&&"section"in t&&"value"in t){var n=e(".tm-builder-sections-uniqid[value='"+t.section+"']").closest(".builder_wrapper"),a=e(n).find(".bitem_wrapper").children(".bitem").not(".element_is_disabled").eq(t.element),l=!1;return e(a).is(".element-radiobuttons,.element-checkboxes,.element-selectbox")?e(a).find(".tm_option_value").each(function(i,n){return e.tmEPOAdmin.tm_escape(e(n).val())==t.value?(l=!0,!1):e(n).val()==t.value?(t.value=e.tmEPOAdmin.tm_escape(t.value),l=!0,!1):void 0}):e(a).is(".element-variations")?e(u.variations).each(function(i,n){if(e.tmEPOAdmin.tm_escape(n.variation_id)==t.value)return l=!0,!1}):l=!0,l?(e(i).removeClass("tm-wrong-rule"),t):(e(i).addClass("tm-wrong-rule"),[])}return[]},logic_reindex:function(){var t=e.tmEPOAdmin.builder_items_sortable_obj;t.start.section==t.end.section&&t.start.section_eq==t.end.section_eq&&t.start.element==t.end.element||(e.tmEPOAdmin.section_logic_reindex(),e.tmEPOAdmin.element_logic_reindex()),e.tmEPOAdmin.builder_items_sortable_obj={start:{},end:{}}},logic_reindex_force:function(){e.tmEPOAdmin.builder_items_sortable_obj.start.section="check",e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="check",e.tmEPOAdmin.builder_items_sortable_obj.start.element="check",e.tmEPOAdmin.builder_items_sortable_obj.end.section="check2",e.tmEPOAdmin.builder_items_sortable_obj.end.section_eq="check2",e.tmEPOAdmin.builder_items_sortable_obj.end.element="check2",e.tmEPOAdmin.section_logic_reindex(),e.tmEPOAdmin.element_logic_reindex(),e.tmEPOAdmin.builder_items_sortable_obj={start:{},end:{}}},is_element_dragged:!1,builder_items_sortable:function(t){e.tmEPOAdmin.is_original&&t.sortable({handle:".move",cursor:"move",items:".bitem",start:function(t,i){if(i.placeholder.height(i.helper.outerHeight()),i.placeholder.width(i.helper.outerWidth()),e.tmEPOAdmin.is_element_dragged=!0,e(i.item).hasClass("ditem"))e.tmEPOAdmin.builder_items_sortable_obj.start.section="drag",e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="drag",e.tmEPOAdmin.builder_items_sortable_obj.start.element="drag";else{var n=e(i.item).closest(".builder_wrapper"),a=n.is(".tm-slider-wizard"),l=e.tmEPOAdmin.find_index(a,e(i.item));n.addClass("tm-zindex").css("zIndex",3),n.find(".tm_builder_sections").val(function(e,t){return--t}),n.find(".tm_builder_section_slides").val(function(t,i){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),e.tmEPOAdmin.builder_items_sortable_obj.start.section=n.find(".tm-builder-sections-uniqid").val(),e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq=n.index(),e.tmEPOAdmin.builder_items_sortable_obj.start.element=l}e(".builder_layout .bitem_wrapper").not(".tma-variations-wrap .bitem_wrapper").addClass("highlight")},stop:function(t,i){e.tmEPOAdmin.is_element_dragged=!1;var n=e(i.item).closest(".builder_wrapper"),a=n.is(".tm-slider-wizard"),l=e.tmEPOAdmin.find_index(a,e(i.item));e(i.item).hasClass("ditem")||(e(".builder_wrapper.tm-zindex").css("zIndex","").removeClass("tm-zindex"),n.find(".tm_builder_sections").val(function(e,t){return++t}),n.find(".tm_builder_section_slides").val(function(t,i){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""})),e.tmEPOAdmin.builder_items_sortable_obj.end.section=n.find(".tm-builder-sections-uniqid").val(),e.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=n.index(),e.tmEPOAdmin.builder_items_sortable_obj.end.element=l,e.tmEPOAdmin.builder_reorder_multiple(),e(i.item).hasClass("ditem")&&(i.draggable=i.item,e.tmEPOAdmin.drag_drop(t,i,e(this))),e.tmEPOAdmin.logic_reindex(),e(".builder_layout .bitem_wrapper").removeClass("highlight")},tolerance:"pointer",forcePlaceholderSize:!0,placeholder:"bitem pl2",forceHelperSize:!0,helper:"clone",cancel:".panels_wrap,.tma-nomove",dropOnEmptyType:!0,revert:200,connectWith:".builder_wrapper:not(.tma-nomove) .bitem_wrapper"})},builder_delete_onClick:function(){if(confirm(tm_epo_admin.i18n_builder_delete)){var t=e(this).closest(".builder_wrapper"),i=e(this).closest(".bitem"),n=t.is(".tm-slider-wizard"),a=e.tmEPOAdmin.find_index(n,i);t.find(".tm_builder_sections").val(function(e,t){return--t}),e.tmEPOAdmin.builder_items_sortable_obj.start.section=t.find(".tm-builder-sections-uniqid").val(),e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq=t.index(),e.tmEPOAdmin.builder_items_sortable_obj.start.element=a,e.tmEPOAdmin.builder_items_sortable_obj.end.section="delete",e.tmEPOAdmin.builder_items_sortable_obj.end.section_eq="delete",e.tmEPOAdmin.builder_items_sortable_obj.end.element="delete",e(this).closest(".bitem").remove(),e.tmEPOAdmin.logic_reindex(),t.find(".tm_builder_section_slides").val(function(i,n){return t.is(".tm-slider-wizard")?t.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),e.tmEPOAdmin.builder_reorder_multiple()}},builder_fold_onClick:function(t){var i=e(this);i.is(".tma-handle")&&(i=i.find(".fold"));var n=i.closest(".tma-handle-wrap").find(".tma-handle-wrapper").first();i.data("folded")||void 0==i.data("folded")?(i.data("folded",!1),i.removeClass("tcfa-caret-up").addClass("tcfa-caret-down"),n.removeClass("tm-hidden")):(i.data("folded",!0),i.removeClass("tcfa-caret-down").addClass("tcfa-caret-up"),n.addClass("tm-hidden"))},builder_section_fold_onClick:function(t){var i=e(this).closest(".builder_wrapper");e(this).data("folded")?(e(this).data("folded",!1),i.removeClass("tm-hide-bitems"),e(this).removeClass("tcfa-caret-up").addClass("tcfa-caret-down")):(e(this).data("folded",!0),i.addClass("tm-hide-bitems"),e(this).removeClass("tcfa-caret-down").addClass("tcfa-caret-up")),e(this).closest(".builder_wrapper").find(".float.builder_drag_elements").remove()},builder_section_delete_onClick:function(){confirm(tm_epo_admin.i18n_builder_delete)&&(e(this).closest(".builder_wrapper").remove(),e.tmEPOAdmin.builder_reorder_multiple(),e(".builder_layout .builder_wrapper").each(function(t,i){e.tmEPOAdmin.logic_init(e(i))}),e.tmEPOAdmin.init_sections_check(),e.tmEPOAdmin.fix_content_float(),e(this).closest(".builder_wrapper").is(".tma-variations-wrap")&&(e.tmEPOAdmin.toggle_variation_button(),e.tmEPOAdmin.var_remove("tm-style-variation-added")))},builder_plus_onClick:function(){var t,i=e.tmEPOAdmin.builder_size(),n=e(this).parentsUntil(".bitem").parent().first();for(t in i)if(n.hasClass(i[t][0])){t<5&&(n.removeClass(""+i[t][0]),n.addClass(""+i[parseInt(parseInt(t)+1)][0]),n.find(".size").text(i[parseInt(parseInt(t)+1)][1]),n.find(".div_size").val(i[parseInt(parseInt(t)+1)][0]));break}},builder_minus_onClick:function(){var t,i=e.tmEPOAdmin.builder_size(),n=e(this).parentsUntil(".bitem").parent().first();for(t in i)if(n.hasClass(i[t][0])){t>0&&(n.removeClass(""+i[t][0]),n.addClass(""+i[parseInt(parseInt(t)-1)][0]),n.find(".size").text(i[parseInt(parseInt(t)-1)][1]),n.find(".div_size").val(i[parseInt(parseInt(t)-1)][0]));break}},builder_section_plus_onClick:function(){var t,i=e.tmEPOAdmin.builder_size(),n=e(this).closest(".builder_wrapper");for(t in i)if(n.hasClass(i[t][0])){t<5&&(n.removeClass(""+i[t][0]),n.addClass(""+i[parseInt(parseInt(t)+1)][0]),n.find(".btitle .size").text(i[parseInt(parseInt(t)+1)][1]),n.find(".tm_builder_sections_size").val(i[parseInt(parseInt(t)+1)][0]));break}},builder_section_minus_onClick:function(){var t,i=e.tmEPOAdmin.builder_size(),n=e(this).closest(".builder_wrapper");for(t in i)if(n.hasClass(i[t][0])){t>0&&(n.removeClass(""+i[t][0]),n.addClass(""+i[parseInt(parseInt(t)-1)][0]),n.find(".btitle .size").text(i[parseInt(parseInt(t)-1)][1]),n.find(".tm_builder_sections_size").val(i[parseInt(parseInt(t)-1)][0]));break}},builder_section_item_onClick:function(){var t=e(this).closest(".builder_wrapper");e.tmEPOAdmin.check_section_logic(t);var i=e.tmEPOAdmin.logic_object;e.tmEPOAdmin.logic_init(t);var n=e(this).closest(".builder_wrapper").find(".section_elements"),a=n.find(".tm-tabs");a.data("tm-has-tmtabs")||a.tmtabs();var l=n.tm_clone();e.tmEPOAdmin.gen_events(t);var o=e.tmEPOAdmin.builder_floatbox_template({id:"temp_for_floatbox_insert",html:"",title:tm_epo_admin.i18n_edit_settings,uniqid:tm_epo_admin.i18n_section_uniqid+":"+n.find(".tm-builder-sections-uniqid").val()}),d=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"80%",height:"80%",classname:"flasho tm_wrapper"+(t.is(".tma-variations-wrap")?" tma-variations-section":""),data:o}),r=!1;e(".details_cancel").click(function(){r||(r=!0,e.tmEPOAdmin.logic_object=i,e.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),l.prependTo(t).addClass("closed"),e.tmEPOAdmin.builder_clone_after_events(l),d&&d.cancelfunc())}),e(".details_update").click(function(){r||(r=!0,e.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),n.find(".tm-builder-clogic").val(e.tmEPOAdmin.logic_get_JSON(n)),n.prependTo(t).addClass("closed"),e.tmEPOAdmin.builder_clone_after_events(n),t.trigger("sections_type_onChange.cpf"),e.tmEPOAdmin.logic_reindex_force(),d&&d.cancelfunc())}),n.appendTo("#temp_for_floatbox_insert").removeClass("closed"),n.find(".sections_style").trigger("change.cpf"),e.tmEPOAdmin.addTinyMCE(".flasho.tm_wrapper")},builder_item_onClick:function(){var t=e(this).closest(".bitem"),i=t.find(".tm-tabs");i.data("tm-has-tmtabs")||i.tmtabs(),e.tmEPOAdmin.panels_sortable(t.find(".panels_wrap")),e.tmEPOAdmin.check_element_logic(t);var n=e.tmEPOAdmin.element_logic_object;e.tmEPOAdmin.element_logic_init(t);var a=e(this).closest(".hstc2"),l=e(this).closest(".hstc2").find(".inside:first"),o=l.tm_clone(),d=l.find(".is_enabled").val();e.tmEPOAdmin.gen_events(t);var r=e.tmEPOAdmin.builder_floatbox_template({id:"temp_for_floatbox_insert",html:"",title:tm_epo_admin.i18n_edit_settings,uniqid:t.is(".element-variations")||0==t.find(".tm-builder-element-uniqid").length?"":tm_epo_admin.i18n_element_uniqid+":"+t.find(".tm-builder-element-uniqid").val()}),s=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"80%",height:"80%",classname:"flasho tm_wrapper",data:r}),m=!1;e(".details_cancel").click(function(){if(!m){m=!0;var t=o.find(".tcpagination");t.data("tc-pagination")&&t.tcPagination("destroy"),e.tmEPOAdmin.element_logic_object=n,e.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),o.appendTo(a),o=o.parentsUntil(".bitem").parent(),e.tmEPOAdmin.builder_clone_after_events(o),s&&s.cancelfunc()}}),e(".details_update").click(function(){if(!m){m=!0;var i=l.find(".tcpagination");i.data("tc-pagination")&&i.tcPagination("destroy"),e.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),l.find(".tm-builder-clogic").val(e.tmEPOAdmin.element_logic_get_JSON(l)),l.appendTo(a),e.tmEPOAdmin.builder_clone_after_events(l),l.find(".tm-header-title").trigger("changetitle.cpf"),e.tmEPOAdmin.logic_reindex_force(),s&&s.cancelfunc(),"0"==l.find(".is_enabled").val()?t.addClass("element_is_disabled"):t.removeClass("element_is_disabled");var n=l.find(".is_enabled").val();if(d!=n){t.closest(".bitem_wrapper");var o=t.closest(".builder_wrapper"),r=e(".builder_layout .builder_wrapper").not(o),c=o.find(".tm-builder-sections-uniqid").val(),_=o.is(".tm-slider-wizard"),u=e.tmEPOAdmin.find_index(_,t),p=e.tmEPOAdmin.find_index(_,t,".bitem",".element_is_disabled");o.find(".bitem").not(t).each(function(t,i){var a=(i=e(i)).find(".tm-builder-clogic").val()||"null";a=a.tmparseJSON(),a=e.tmEPOAdmin.logic_check_rules_reindex(i,a,u,p,c,n),i.find(".tm-builder-clogic").val(JSON.stringify(a))}),r.each(function(i,a){var l=(a=e(a)).find(".section_elements"),o=l.find(".tm-builder-clogic").val()||"null";o=o.tmparseJSON(),o=e.tmEPOAdmin.logic_check_rules_reindex(a,o,u,p,c,n),l.find(".tm-builder-clogic").val(JSON.stringify(o)),a.find(".bitem").not(t).each(function(t,i){var l=(i=e(i)).find(".tm-builder-clogic").val()||"null";l=l.tmparseJSON(),l=e.tmEPOAdmin.logic_check_rules_reindex(a,l,u,p,c,n),i.find(".tm-builder-clogic").val(JSON.stringify(l))})})}}}),l.appendTo("#temp_for_floatbox_insert"),t.is(".element-variations")?e.tmEPOAdmin.variations_display_as():e.tmEPOAdmin.tm_upload(),e("#temp_for_floatbox_insert").find(".tm_select_price_type").trigger("change.cpf"),e.tm_tooltip(e("#temp_for_floatbox_insert").find(".tm-tooltip")),e.tmEPOAdmin.tm_weekdays(e("#temp_for_floatbox_insert")),e.tmEPOAdmin.tm_url(),e.tmEPOAdmin.tm_qty_selector(),e.tmEPOAdmin.tm_pricetype_selector(),e.tmEPOAdmin.addTinyMCE(".flasho.tm_wrapper"),e.tmEPOAdmin.paginattion_init()},logic_check_rules_reindex:function(t,i,n,a,l,o){"object"==typeof i&&null!==i||(i={}),"toggle"in i||(i.toggle="show"),"what"in i||(i.what="any"),"rules"in i||(i.rules=[]);var d=i;e.tmEPOAdmin.element_logic_object;return n=parseInt(n),a=parseInt(a),o=parseInt(o),e.each(i.rules,function(e,i){var a=i.section,r=i.element;a==l&&r.toString().tm_isNumeric()&&(r=parseInt(r),n==r?0==o?(delete d.rules[e],t.addClass("tm-wrong-rule")):1==o&&(r++,d.rules[e].element=r.toString()):n<r&&(0==o?(r--,d.rules[e].element=r.toString()):1==o&&(r++,d.rules[e].element=r.toString())))}),d.rules=e.tm_array_values(d.rules),d},drag_drop:function(t,i,n){var a=e(i.draggable).attr("class").split(/\s+/).filter(function(e){return-1===e.indexOf("element-")?"":-1===e.indexOf("-element-")?e:""}).toString();(a=a.replace(/element-/gi,""))&&e.tmEPOAdmin.builder_clone_element(a,n.closest(".builder_wrapper"))},builder_clone_element:function(t,i,n){var a=e.fn.tm_template(p.tc_builder_elements,{});if(a){n||(n="append"),i=e(i);var l=e(a).filter(".bitem.element-"+t).tm_clone(!0);if(l){if(l.find(".tm-builder-element-uniqid").val(e.tm_uniqid("",!0)),e(".builder_wrapper").length<=0&&e.tmEPOAdmin.builder_add_section_onClick(),l.addClass("appear"),e.tmEPOAdmin.set_field_title(l),i.find(".bitem_wrapper").find(".ditem").length>0?i.find(".bitem_wrapper").find(".ditem").replaceWith(l):("append"==n&&i.find(".bitem_wrapper").not(".tm-hide").append(l),"prepend"==n&&i.find(".bitem_wrapper").not(".tm-hide").prepend(l)),i.find(".tm_builder_sections").val(function(e,t){return++t}),i.find(".tm_builder_section_slides").val(function(t,n){return i.is(".tm-slider-wizard")?i.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),l.find(".tm-tabs").tmtabs(),l.find(".tm-header-title").data("id",l),e.tmEPOAdmin.panels_sortable(l.find(".panels_wrap")),"prepend"==n||"append"==n){var o=i.is(".tm-slider-wizard"),d=e.tmEPOAdmin.find_index(o,l);e.tmEPOAdmin.builder_items_sortable_obj.start.section="drag",e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="drag",e.tmEPOAdmin.builder_items_sortable_obj.start.element="drag",e.tmEPOAdmin.builder_items_sortable_obj.end.section=i.find(".tm-builder-sections-uniqid").val(),e.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=i.index(),e.tmEPOAdmin.builder_items_sortable_obj.end.element=d}return e.tmEPOAdmin.check_element_logic(l),e.tmEPOAdmin.builder_reorder_multiple(),l}}},builder_clone_onClick:function(t){if(t.preventDefault(),confirm(tm_epo_admin.i18n_builder_clone)){var i=e(this).closest(".bitem"),n=i.data("original_title"),a=i.tm_clone();if(a.data("original_title",n),a){i.after(a);var l=a.closest(".builder_wrapper").is(".tm-slider-wizard"),o=e.tmEPOAdmin.find_index(l,a);a.closest(".builder_wrapper").find(".tm_builder_sections").val(function(e,t){return++t}),a.closest(".builder_wrapper").find(".tm_builder_section_slides").val(function(t,i){return a.closest(".builder_wrapper").is(".tm-slider-wizard")?a.closest(".builder_wrapper").find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),a.find(".tm-header-title").data("id",a),a.find(".tm-builder-element-uniqid").val(e.tm_uniqid("",!0)),a.find(".tcpagination").tcPagination("destroy"),e.tmEPOAdmin.builder_clone_after_events(a),e.tmEPOAdmin.builder_reorder_multiple(),e.tmEPOAdmin.builder_items_sortable_obj.start.section="clone",e.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="clone",e.tmEPOAdmin.builder_items_sortable_obj.start.element="clone",e.tmEPOAdmin.builder_items_sortable_obj.end.section=i.closest(".builder_wrapper").find(".tm-builder-sections-uniqid").val(),e.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=i.closest(".builder_wrapper").index(),e.tmEPOAdmin.builder_items_sortable_obj.end.element=o,e.tmEPOAdmin.logic_reindex()}}},builder_section_clone_onClick:function(t){if(t.preventDefault(),confirm(tm_epo_admin.i18n_builder_clone)){var i=e(this).closest(".builder_wrapper"),n=i.tm_clone();if(n){n.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0));var a=[];i.find(".bitem").each(function(t,i){a[t]=e(i).data("original_title")}),i.after(n),n.find(".bitem").each(function(t,i){e(i).data("original_title",a[t]),e(i).find(".tm-header-title").data("id",e(i))}),"slider"==n.find(".section_elements .sections_type").val()&&e.tmEPOAdmin.create_slider(n),e.tmEPOAdmin.builder_reorder_multiple(),e.tmEPOAdmin.builder_items_sortable(n.find(".bitem_wrapper")),e.tmEPOAdmin.builder_clone_after_events(n),n.find(".tm-builder-sections-uniqid").val(e.tm_uniqid("",!0)),e.tmEPOAdmin.check_section_logic(n),e.tmEPOAdmin.check_element_logic(),e.tmEPOAdmin.logic_init(n),n.addClass("appear")}}},builder_size:function(){var e=[];return e[0]=["w25","1/4"],e[1]=["w33","1/3"],e[2]=["w50","1/2"],e[3]=["w66","2/3"],e[4]=["w75","3/4"],e[5]=["w100","1/1"],e},builder_floatbox_template:function(e){var t="";return e.uniqid&&(t="<span class='tm-element-uniqid'>"+e.uniqid+"</span>"),"<div class='header'><h3>"+e.title+"</h3>"+t+"</div><div id='"+e.id+"' class='float_editbox'>"+e.html+"</div><div class='footer'><div class='inner'><button type='button' class='tc tc-button details_update'>"+tm_epo_admin.i18n_update+"</button>&nbsp;<button type='button' class='tc tc-button details_cancel'>"+tm_epo_admin.i18n_cancel+"</button></div></div>"},builder_floatbox_template_import:function(e){return"<div class='header'><h3>"+e.title+"</h3></div><div id='"+e.id+"' class='float_editbox'>"+e.html+"</div><div class='footer'><div class='inner'><button type='button' class='tc tc-button details_cancel'>"+tm_epo_admin.i18n_cancel+"</button></div></div>"},builder_reorder_multiple:function(){for(var t=e(".builder_layout").find('[name^="tm_meta\\[tmfbuilder\\]\\[multiple_"]').map(function(){return e(this).closest(".bitem").attr("class").split(" ").map(function(e){if(-1!==e.indexOf("element-",0))return e}).filter(function(e,t,i){if(null!==e&&void 0!==e)return e})}).toArray(),i=[],n=0;n<t.length;n++)-1==jQuery.inArray(t[n],i)&&i.push(t[n]);var a={};for(var l in i)"function"!=typeof i[l]&&e(".builder_layout ."+i[l]).each(function(t,i){e(i).find(".tm-default-radio").each(function(i,n){var l=e(n).attr("name"),o=/\[[0-9]+\]\[\]/g,d=/\[[0-9]+\]/g;null!=l.match(o)?l=l.replace(o,"["+t+"][]"):null!=l.match(d)&&(l=l.replace(d,"["+t+"]"));var r=l.replace(/[\[\]]/g,"");a[r]=r in a?parseInt(a[r])+1:0;var s=!1;e(n).is(":radio:checked")&&(s=!0),l+="_temp",e(n).attr("name",l),s?e(n).attr("checked","checked").prop("checked",!0):e(n).removeAttr("checked").prop("checked",!1)}),e(i).find("[name]").not(".tm-default-radio").attr("name",function(){var i=e(this).attr("name"),n=/\[[0-9]+\]\[\]/g,l=/\[[0-9]+\]/g;null!=i.match(n)?i=i.replace(n,"["+t+"][]"):null!=i.match(l)&&(i=i.replace(l,"["+t+"]"));var o=i.replace(/[\[\]]/g,"");return a[o]=o in a?parseInt(a[o])+1:0,e(this).attr("id",o+"_"+a[o]),i})});e(".builder_layout").find(".tm-default-radio").each(function(t,i){var n=e(i).attr("name");n=n.replace(/_temp/g,""),e(this).attr("name",n)}),e(".builder_layout").find("[name]").not('[name^="tm_meta\\[tmfbuilder\\]\\[multiple_"]').each(function(t,i){var n=e(this).attr("name").replace(/[\[\]]/g,"");a[n]=n in a?parseInt(a[n])+1:0,e(i).attr("id",n+a[n])}),e.tmEPOAdmin.id_array=a},builder_clone_after_events:function(t){t.find("input.tm-color-picker").spectrum("destroy"),t.find(".sp-replacer").remove(),e.tmEPOAdmin.panels_sortable(t.find(".panels_wrap")),t.find(".tm-tabs").tmtabs()},gen_events:function(t){t||(t=e(".builder_layout ")),t.find("input.tm-color-picker").spectrum({showInput:!0,showInitial:!0,allowEmpty:!0,showAlpha:!1,showPalette:!1,clickoutFiresChange:!0,showButtons:!1,preferredFormat:"hex"})},paginattion_init:function(t){var i=e("#temp_for_floatbox_insert"),n=i.find(".tcpagination");if(0!==n.length){var a=i.find(".panels_wrap").find(".options_wrap"),l=parseInt(n.attr("data-perpage")),o=Math.ceil(a.length/l);n.data("tc-pagination")&&n.tcPagination("destroy"),t="last"==t?o:"current"==t?e.tmEPOAdmin.pagination_current:1,e.tmEPOAdmin.pagination_current=t,n.tcPagination({totalPages:o,startPage:t,visiblePages:10,onPageClick:function(t,i){e.tmEPOAdmin.paginationOnClick(i,l,a)}})}},paginationOnClick:function(t,i,n){var t=parseInt(t);e.tmEPOAdmin.pagination_current=t,n.addClass("tm-hidden");for(var a=i*t-1;a>=i*(t-1);a--)n.eq(a).removeClass("tm-hidden")},addTinyMCE:function(t){if(e(t)&&"undefined"!=typeof tinymce){var i,n,a,l={theme:"modern",menubar:!1,wpautop:!0,indent:!1,toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link,unlink",plugins:"fullscreen,image,wordpress,wpeditimage,wplink"},o={buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close,fullscreen"},d="object"==typeof tinyMCEPreInit&&"mceInit"in tinyMCEPreInit&&"excerpt"in tinyMCEPreInit.mceInit?tinyMCEPreInit.mceInit.excerpt:l,r="object"==typeof tinyMCEPreInit&&"qtInit"in tinyMCEPreInit&&"excerpt"in tinyMCEPreInit.qtInit?tinyMCEPreInit.qtInit.excerpt:o,s=e("#wp-excerpt-editor-tools").html(),m=e("#wp-excerpt-editor-tools").attr("class");e(t).find("textarea").not(":disabled").not(".tm-no-editor").each(function(t,l){(n=e(l).attr("id"))&&(i=e.extend({},d,{selector:"#"+n}),a=e.extend({},r,{id:n}),"object"==typeof tinyMCEPreInit&&(tinyMCEPreInit.mceInit[n]=i,tinyMCEPreInit.qtInit[n]=a),e(l).addClass("wp-editor-area").wrap('<div id="wp-'+n+'-wrap" class="wp-core-ui wp-editor-wrap tmce-active tm_editor_wrap"></div>').before('<div class="'+m+'">'+s+"</div>").wrap('<div class="wp-editor-container"></div>'),e(".tm_editor_wrap").find(".wp-switch-editor").each(function(t,i){if(e(i).attr("id")){var a=e(i).attr("id"),l=a.length,o=a.substr(l-4);e(i).attr("id",n+"-"+o),e(i).attr("data-wp-editor-id",n)}}),e(".tm_editor_wrap").find(".insert-media").attr("data-editor",n),tinymce.init(i),QTags&&quicktags&&(quicktags(a),QTags._buttonsInit()),e(l).closest(".tm_editor_wrap").find("a.insert-media").data("editor",n).attr("data-editor",n))})}},removeTinyMCE:function(t){if(e(t)&&"undefined"!=typeof tinyMCE){var i,n="";e(t).find("textarea").not(":disabled").not(".tm-no-editor").each(function(t,a){if((i=e(a).attr("id"))&&tinyMCE&&tinyMCE.editors){var l=e(a).val(),o="undefined"!=typeof tinyMCE&&tinyMCE.editors[i]&&!tinyMCE.editors[i].isHidden();i in tinyMCE.editors&&(n=tinyMCE.editors[i].getContent(),tinyMCE.editors[i].remove()),e(a).closest(".tm_editor_wrap").find(".quicktags-toolbar,.wp-editor-tools").remove(),e(a).unwrap().unwrap(),o?""==n?e(a).val(""):e(a).val(n):e(a).val(l)}})}},set_fields_change:function(t){t||(t=e(".builder_textfield_price_type")),0!=e(t).length&&t.each(function(t,i){var n=e(this).closest(".builder_element_wrap").find(".builder_price_div");"currentstep"==e(this).val()?e(n).length&&n.hide():e(n).length&&n.show()})},set_field_title:function(t){if(t||(t=e(".bitem")).each(function(t,i){if(0==e(i).find(".tm-header-title").length)return!0;var n=e(i);e(i).find(".tm-header-title").data("id",n);var a=e(i).find(".tm-header-title").val();void 0!==a&&""!=a&&e(i).find(".tm-label").html(a)}),0!=e(t).length&&t.is(".tm-header-title")){var i=t.val(),n=t.data("id");void 0===i||""==i?e(n).find(".tm-label").html("&nbsp;"):e(n).find(".tm-label").html(i)}},set_hidden:function(){e(".builder_wrapper").each(function(t,i){var n=e(this);n.find(".tm_builder_sections").val(e(this).find(".bitem ").length),n.find(".tm_builder_section_slides").val(function(t,i){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(t,i){return e(i).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),n.find(".tm_builder_sections_size").val(function(){return e(i).attr("class").split(" ").map(function(e){if(null!==e.match(/w\d+/g))return e}).filter(function(e,t,i){if(null!==e&&void 0!==e)return e})[0]}),n.find(".div_size").val(function(){return e(this).closest(".bitem").attr("class").split(" ").map(function(e){if(-1!==e.indexOf("w",0))return e}).filter(function(e,t,i){if(null!==e&&void 0!==e)return e})[0]})})},tm_upload_button_remove_onClick:function(t){var i=e(this).prevAll("input").first(),n=e(this).nextAll(".tm_upload_image").first().find(".tm_upload_image_img");e(i).val(""),e(n).attr("src","")},variations_display_as:function(t){var i,n,a;(t?e(this).is(".tm-changes-product-image")?e(this).closest(".tm-attribute").find(".variations-display-as"):e(this):e("#temp_for_floatbox_insert .variations-display-as")).each(function(t,l){i=e(l).closest(".tm-attribute"),n=i.find(".tm-term"),a=i.find(".tm-changes-product-image");var o=e(l).val();"select"==o?i.find(".tma-hide-for-select-box").hide().addClass("tm-row-hidden"):i.find(".tma-hide-for-select-box").show().removeClass("tm-row-hidden"),"image"==o||"color"==o||"radiostart"==o||"radioend"==o?i.find(".tma-show-for-swatches").show().removeClass("tm-row-hidden"):i.find(".tma-show-for-swatches").hide().addClass("tm-row-hidden"),n.each(function(t,i){switch(e(i).hide().find(".tma-term-color,.tma-term-image,.tma-term-custom-image").hide(),o){case"select":case"radio":"images"==a.val()&&a.val(""),a.children("option[value='images']").attr("disabled","disabled").hide(),"custom"==a.val()&&e(i).show().find(".tma-term-custom-image").show();break;case"image":case"radiostart":case"radioend":a.children("option[value='images']").removeAttr("disabled").show(),e(i).show().find(".tma-term-image").show(),"custom"==a.val()&&e(i).show().find(".tma-term-custom-image").show();break;case"color":"images"==a.val()&&a.val(""),a.children("option[value='images']").attr("disabled","disabled").hide(),"custom"==a.val()&&e(i).show().find(".tma-term-custom-image").show(),e(i).show().find(".tma-term-color").show()}})})},tm_upload:function(t){var i=e("#temp_for_floatbox_insert"),n=i.find(".use_images").not(".tm-changes-product-image"),a=i.find(".use_colors"),l=i.find(".tm-use-images"),o=i.find(".tm-use-colors"),d=i.find(".tm-changes-product-image"),r=e("#temp_for_floatbox_insert .tm-show-when-use-images"),s=i.find(".builder_element_wrap").find(".tm_upload_button").not(".tm_upload_buttonp,.tm_upload_buttonl"),m=i.find(".builder_element_wrap").find(".tm_upload_image").not(".tm_upload_imagep,.tm_upload_imagel"),c=i.find(".builder_element_wrap").find(".tm_upload_buttonp"),_=i.find(".builder_element_wrap").find(".tm_upload_imagep"),u=i.find(".builder_element_wrap").find(".tm_upload_buttonl"),p=i.find(".builder_element_wrap").find(".tm_upload_imagel"),f=i.find(".builder_element_wrap").find(".tm_cell_images"),v=i.find(".builder_element_wrap .panels_wrap").find(".sp-replacer");if(s.hide(),m.hide(),c.hide(),_.hide(),u.hide(),p.hide(),f.hide(),v.hide(),""!=n.val()&&""!=a.val()&&(o.show(),l.show()),""==n.val()&&""==a.val()&&(o.show(),l.show()),""!=n.val()&&""==a.val()&&(o.hide(),l.show()),""==n.val()&&""!=a.val()&&(o.show(),l.hide()),"images"==d.val()&&""==n.val()){var b=i.find(".tm_option_image").not(".tm_option_imagep"),h=i.find(".tm_option_imagep"),g=i.find(".tm_upload_imagep .tm_upload_image_img");d.val("custom"),b.each(function(t,i){h.eq(t).val(e(this).val()),g.attr("src",e(this).val())})}n.length&&"images"==n.val()?d.find("option[value='images']").removeAttr("disabled").show():("images"==d.val()&&d.val(""),d.find("option[value='images']").attr("disabled","disabled").hide()),("images"==n.val()||"start"==n.val()||"end"==n.val()||"images"==n.val()&&"images"==d.val())&&(s.show(),m.show(),f.show()),"custom"==d.val()&&(c.show(),_.show(),f.show()),"images"==n.val()?(r.show(),"lightbox"==e("#temp_for_floatbox_insert .tm-use-lightbox").val()&&(u.show(),p.show())):r.hide(),"color"!=a.val()&&"start"!=a.val()&&"end"!=a.val()||(f.show(),v.show())},tm_weekdays:function(t){e(t?t:"body").find(".tm-weekdays").each(function(t,i){var n=e(i).val().split(","),a=e(i).next(".tm-weekdays-picker-wrap");e(a).find(".tm-weekday-picker").each(function(t,i){-1!=n.indexOf(e(i).val())?(e(i).attr("checked","checked").prop("checked",!0),e(i).closest(".tm-weekdays-picker").addClass("tm-checked")):(e(i).removeAttr("checked").prop("checked",!1),e(i).closest(".tm-weekdays-picker").removeClass("tm-checked"))})})},tm_weekday_picker:function(t){var i=e(this).closest(".tm-weekdays-picker-wrap").prev(".tm-weekdays"),n=e(i).val().split(","),a=n.indexOf(e(this).val());e(this).is(":checked")?-1==a&&n.push(e(this).val()):-1!=a&&n.splice(a,1),n=e.map(n,function(e){return""===e?null:e}),e(i).val(n.join(",")),e.tmEPOAdmin.tm_weekdays(e(i).parent())},tm_qty_selector:function(t){var i,n;n=e(t?this:"#temp_for_floatbox_insert .tm-qty-selector");var a=(i=e("#temp_for_floatbox_insert")).find(".builder_element_wrap").find(".tm-show-for-quantity");""!=n.val()?a.show():a.hide()},tm_pricetype_selector:function(t){var i,n;n=e(t?this:"#temp_for_floatbox_insert .tm-pricetype-selector");var a=(i=e("#temp_for_floatbox_insert")).find(".builder_element_wrap").find(".tm-show-for-per-chars");"charnon"==n.val()||"charnonnospaces"==n.val()||"charpercentnon"==n.val()||"charpercentnonnospaces"==n.val()?a.show():a.hide()},tm_url:function(t){var i=e("#temp_for_floatbox_insert"),n=e(this),a=i.find(".builder_element_wrap").find(".tm_cell_url");t||(n=e("#temp_for_floatbox_insert .use_url")),"url"==n.val()?a.show():a.hide()},upload:function(t){if(t.preventDefault(),!wp||!wp.media)return!1;var i=e(this).prev("input"),n=e(this).nextAll(".tm_upload_image").first().find("img");if(i.data("tm_upload_frame"))i.data("tm_upload_frame").open();else{var a=wp.media.controller.Library.extend({defaults:_.defaults({id:"insert-image",title:"Insert Image Url",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!0,type:"image"},wp.media.controller.Library.prototype.defaults)}),l=wp.media({button:{text:"Select"},state:"insert-image",states:[new a]});l.on("close",function(){}),l.on("select",function(){var e=l.state("insert-image"),t=e.get("selection");t&&(n.attr("src",""),i.val(""),t.each(function(t){var a,l=e.display(t).toJSON(),o=t.toJSON(),d=o.caption;wp.media.view.settings.captions||delete o.caption,l=wp.media.string.props(l,o),a={id:o.id,post_content:o.description,post_excerpt:d},l.linkUrl&&(a.url=l.linkUrl),"image"===o.type?(wp.media.string.image(l),_.each({align:"align",size:"image-size",alt:"image_alt"},function(e,t){l[t]&&(a[e]=l[t])}),a["image-size"]&&t.attributes.sizes[a["image-size"]]&&(a.url=t.attributes.sizes[a["image-size"]].url)):"video"===o.type?wp.media.string.video(l,o):"audio"===o.type?wp.media.string.audio(l,o):(wp.media.string.link(l),a.post_title=l.title),n.attr("src",a.url),i.val(a.url)}))}),l.on("open",function(){var t=l.state().get("library").toJSON(),n=!0;e.each(t,function(t,a){if(a.url==i.val()){var o=wp.media.attachment(a.id);l.state().get("selection").add(o?[o]:[]),e(".attachment-display-settings").find("select.size").val("full"),n=!1}else a.sizes&&e.each(a.sizes,function(t,o){if(o.url==i.val()){var d=wp.media.attachment(a.id);l.state().get("selection").add(d?[d]:[]),e(".attachment-display-settings").find("select.size").val(t),n=!1}});n&&e(".attachment-display-settings").find("select.size").val("full")})}),i.data("tm_upload_frame",l),l.open()}}};var f=0;e(document).ready(function(){e.tmEPOAdmin.initialitize();var m=e("#bulk-action-selector-top");if(m.length>0){var _=!1;m.children("option").each(function(t,i){"tcline"===e(i).val()?(_=!0,e(i).replaceWith(e('<optgroup class="tc-bulk-opt" label="'+e(i).text()+'">'))):_&&"tcclear"!==e(i).val()&&"tcclearexclude"!==e(i).val()&&"tcclearexcludeadd"!==e(i).val()&&e(i).appendTo(e(".tc-bulk-opt")),"tcline2"===e(i).val()&&e(i).remove()})}var u=e(".tm-settings-wrap");if(u.length>0){var p=u.find(":checkbox");p.closest("label").addClass("tm-epo-style-wrapper-label"),p.wrap('<span class="tm-epo-style-wrapper tc"></span>'),p.after('<span class="tc-label tm-epo-style tc"></span>'),e(window).on("tc-opentab.tmtabs tc-isopentab.tmtabs",function(t,i){var n=i.table.find(".tm-section-desc .tm-section-menu-item");if(n.length>0){var a=wpCookies.get("tmadminextratab"),l=n.filter('[data-menu="'+a+'"]'),o=i.table.find("select,input,text,textarea");a&&0!==l.length||(a=(l=e(n).eq(0)).attr("data-menu")),c(a,l,o,i.table)}}),e(document).on("click",".tm-section-menu-item",function(t){var i=e(this),n=i.attr("data-menu"),a=i.closest(".tm-tab");c(n,i,a.find("select,input,text,textarea"),a),wpCookies.set("tmadminextratab",n,10080,"")}),e(window).on("tc-tmtabs-clicked",function(t,i){if((d=i.table.find(".tm-section-desc .tm-section-menu-item")).length>0){var n,a=wpCookies.get("tmadminextratab"),l=wpCookies.get("tmadminextratab-context"),o=i.header.attr(i.options.dataattribute),d=i.table.find(".tm-section-desc .tm-section-menu-item"),r=i.table.find("select,input,text,textarea");a&&l==o?n=d.filter('[data-menu="'+a+'"]'):a=(n=e(d).eq(0)).attr("data-menu"),n.length>0&&!n.is(".active")&&(c(a,n,r,i.table),wpCookies.set("tmadminextratab-context",o))}}),e(document).on("click",".tc-save-button",function(t){t.preventDefault();var i=e(this).closest("form");i.block({message:null,overlayCSS:{background:"#fff url("+tm_epo_admin.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var n="&security="+tm_epo_admin.settings_nonce;e.post(tm_epo_admin.ajax_url,i.serialize()+"&save=save&action=tm_save_settings"+n,function(e){e&&(1==e.error?toastr.error(e.message,tm_epo_admin.i18n_epo):toastr.success(e.message,tm_epo_admin.i18n_epo))},"json").always(function(e){i.unblock()})}),e(".tm-settings-wrap .tm-tabs").tmtabs(),e(".tm-activate-license").on("click",function(e){e.preventDefault(),t("activate")}),e(".tm-deactivate-license").on("click",function(e){e.preventDefault(),t("deactivate")}),e("#tm_epo_display").on("change",function(t){i(e(this))}),e("#tm_epo_options_placement").on("change",function(t){n(e(this))}),e("#tm_epo_totals_box_placement").on("change",function(t){o(e(this))}),e("#tm_epo_css_styles").on("change",function(t){d(e(this))}),e("#tm_epo_css_selected_border").on("change",function(t){s(e(this))}),e("#tm_epo_floating_totals_box").on("change",function(t){a(e(this))}),e("#tm_epo_show_price_inside_option").on("change",function(t){l(e(this))}),i(e("#tm_epo_display")),n(e("#tm_epo_options_placement")),o(e("#tm_epo_totals_box_placement")),d(e("#tm_epo_css_styles")),r(e("#tm_epo_css_selected_border")),s(e("#tm_epo_css_selected_border")),a(e("#tm_epo_floating_totals_box")),l(e("#tm_epo_show_price_inside_option")),e(document).on("click.cpf",".tm-mn-movetodir,.tm-mn-deldir,.tm-mn-delfile",function(t){t.preventDefault();var i=e(this),n=e(".forminp-tm_html");if(n.length>0){if(n.data("doing_ajax"))return;if(i.is(".tm-mn-deldir")&&!confirm(tm_epo_admin.i18n_mn_delete_folder))return;if(i.is(".tm-mn-delfile")&&!confirm(tm_epo_admin.i18n_mn_delete_file))return;i.prepend('<i class="tm-icon tcfa tcfa-refresh tcfa-spin"></i>'),n.data("doing_ajax",1).block({message:null,overlayCSS:{background:"#fff url("+tm_epo_admin.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var a={action:"tm_mn_movetodir",dir:i.attr("data-tm-dir"),security:tm_epo_admin.settings_nonce};i.is(".tm-mn-deldir")?(a.action="tm_mn_deldir",a.tmdir=i.attr("data-tm-deldir")):i.is(".tm-mn-delfile")&&(a.action="tm_mn_delfile",a.tmfile=i.attr("data-tm-delfile"),a.tmdir=i.attr("data-tm-deldir")),e.post(tm_epo_admin.ajax_url,a,function(t){if(t&&t.result&&""!=t.result)n.html(t.result);else if(t&&t.error&&t.message){var i=e.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:tm_epo_admin.i18n_error_title}),a=e("body").tm_floatbox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:i});e(".details_cancel").click(function(){a&&a.cancelfunc()})}},"json").always(function(e){n.data("doing_ajax",0).unblock(),i.find(".tm-icon").remove()})}})}e.tm_tooltip()})}(jQuery);